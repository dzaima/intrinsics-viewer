<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="The vector cryptography extensions for the RISC-V ISA.">
<title>RISC-V Cryptography Extensions Volume II: Vector Instructions</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #3D7B7B; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #9C6500 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
pre.pygments .tok-gr { color: #E40000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #008400 } /* Generic.Inserted */
pre.pygments .tok-go { color: #717171 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #687822 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #717171; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #767600 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #A45A77 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body id="riscv-doc-template" class="book toc2 toc-left">
<div id="header">
<h1>RISC-V Cryptography Extensions Volume II: Vector Instructions</h1>
<div class="details">
<span id="revnumber">version v1.0.0,</span>
<span id="revdate">05 October 2023</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_colophon">Colophon</a></li>
<li><a href="#_acknowledgments">Acknowledgments</a></li>
<li><a href="#crypto_vector_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#crypto_vector_audience">1.1. Intended Audience</a></li>
<li><a href="#crypto_vector_sail_specifications">1.2. Sail Specifications</a></li>
<li><a href="#crypto_vector_policies">1.3. Policies</a></li>
<li><a href="#crypto-vector-element-groups">1.4. Element Groups</a></li>
<li><a href="#crypto-vector-instruction-constraints">1.5. Instruction Constraints</a></li>
<li><a href="#crypto-vector-scalar-instructions">1.6. Vector-Scalar Instructions</a></li>
<li><a href="#crypto-vector-software-portability">1.7. Software Portability</a></li>
</ul>
</li>
<li><a href="#crypto_vector_extensions">2. Extensions Overview</a>
<ul class="sectlevel2">
<li><a href="#zvbb">2.1. <code>Zvbb</code> - Vector Basic Bit-manipulation</a></li>
<li><a href="#zvbc">2.2. <code>Zvbc</code> - Vector Carryless Multiplication</a></li>
<li><a href="#zvkb">2.3. <code>Zvkb</code> - Vector Cryptography Bit-manipulation</a></li>
<li><a href="#zvkg">2.4. <code>Zvkg</code> - Vector GCM/GMAC</a></li>
<li><a href="#zvkned">2.5. <code>Zvkned</code> - NIST Suite: Vector AES Block Cipher</a></li>
<li><a href="#zvknh">2.6. <code>Zvknh[ab]</code> - NIST Suite: Vector SHA-2 Secure Hash</a></li>
<li><a href="#zvksed">2.7. <code>Zvksed</code> - ShangMi Suite: SM4 Block Cipher</a></li>
<li><a href="#zvksh">2.8. <code>Zvksh</code> - ShangMi Suite: SM3 Secure Hash</a></li>
<li><a href="#zvkn">2.9. <code>Zvkn</code> - NIST Algorithm Suite</a></li>
<li><a href="#zvknc">2.10. <code>Zvknc</code> - NIST Algorithm Suite with carryless multiply</a></li>
<li><a href="#zvkng">2.11. <code>Zvkng</code> - NIST Algorithm Suite with GCM</a></li>
<li><a href="#zvks">2.12. <code>Zvks</code> - ShangMi Algorithm Suite</a></li>
<li><a href="#zvksc">2.13. <code>Zvksc</code> - ShangMi Algorithm Suite with carryless multiplication</a></li>
<li><a href="#zvksg">2.14. <code>Zvksg</code> - ShangMi Algorithm Suite with GCM</a></li>
<li><a href="#zvkt">2.15. <code>Zvkt</code> - Vector Data-Independent Execution Latency</a>
<ul class="sectlevel3">
<li><a href="#_all_zvbb_instructions">2.15.1. All Zvbb  instructions:</a></li>
<li><a href="#_all_zvbc_instructions">2.15.2. All Zvbc instructions</a></li>
<li><a href="#_addsub">2.15.3. add/sub</a></li>
<li><a href="#_addsub_with_carry">2.15.4. add/sub with carry</a></li>
<li><a href="#_compare_and_set">2.15.5. compare and set</a></li>
<li><a href="#_copy">2.15.6. copy</a></li>
<li><a href="#_extend">2.15.7. extend</a></li>
<li><a href="#_logical">2.15.8. logical</a></li>
<li><a href="#_multiply">2.15.9. multiply</a></li>
<li><a href="#_multiply_add">2.15.10. multiply-add</a></li>
<li><a href="#_integer_merge">2.15.11. Integer Merge</a></li>
<li><a href="#_permute">2.15.12. permute</a></li>
<li><a href="#_shift">2.15.13. shift</a></li>
<li><a href="#_slide">2.15.14. slide</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#crypto_vector_insns">3. Instructions</a>
<ul class="sectlevel2">
<li><a href="#insns-vaesdf">3.1. vaesdf.[vv,vs]</a></li>
<li><a href="#insns-vaesdm">3.2. vaesdm.[vv,vs]</a></li>
<li><a href="#insns-vaesef">3.3. vaesef.[vv,vs]</a></li>
<li><a href="#insns-vaesem">3.4. vaesem.[vv,vs]</a></li>
<li><a href="#insns-vaeskf1">3.5. vaeskf1.vi</a></li>
<li><a href="#insns-vaeskf2">3.6. vaeskf2.vi</a></li>
<li><a href="#insns-vaesz">3.7. vaesz.vs</a></li>
<li><a href="#insns-vandn">3.8. vandn.[vv,vx]</a></li>
<li><a href="#insns-vbrev">3.9. vbrev.v</a></li>
<li><a href="#insns-vbrev8">3.10. vbrev8.v</a></li>
<li><a href="#insns-vclmul">3.11. vclmul.[vv,vx]</a></li>
<li><a href="#insns-vclmulh">3.12. vclmulh.[vv,vx]</a></li>
<li><a href="#insns-vclz">3.13. vclz.v</a></li>
<li><a href="#insns-vcpop">3.14. vcpop.v</a></li>
<li><a href="#insns-vctz">3.15. vctz.v</a></li>
<li><a href="#insns-vghsh">3.16. vghsh.vv</a></li>
<li><a href="#insns-vgmul">3.17. vgmul.vv</a></li>
<li><a href="#insns-vrev8">3.18. vrev8.v</a></li>
<li><a href="#insns-vrol">3.19. vrol.[vv,vx]</a></li>
<li><a href="#insns-vror">3.20. vror.[vv,vx,vi]</a></li>
<li><a href="#insns-vsha2c">3.21. vsha2c[hl].vv</a></li>
<li><a href="#insns-vsha2ms">3.22. vsha2ms.vv</a></li>
<li><a href="#insns-vsm3c">3.23. vsm3c.vi</a></li>
<li><a href="#insns-vsm3me">3.24. vsm3me.vv</a></li>
<li><a href="#insns-vsm4k">3.25. vsm4k.vi</a></li>
<li><a href="#insns-vsm4r">3.26. vsm4r.[vv,vs]</a></li>
<li><a href="#insns-vwsll">3.27. vwsll.[vv,vx,vi]</a></li>
</ul>
</li>
<li><a href="#bibliography">4. Bibliography</a></li>
<li><a href="#Encodings">5. Encodings</a>
<ul class="sectlevel2">
<li><a href="#crypto_vector_instructions">Appendix A: Crypto Vector Cryptographic Instructions</a></li>
<li><a href="#crypto_vector_instructions_Zvbb_Zvbc">Appendix B: Vector Bitmanip and Carryless Multiply Instructions</a></li>
</ul>
</li>
<li><a href="#crypto_vector_appx_sail">Appendix C: Supporting Sail Code</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_colophon">Colophon</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the Vector Cryptography extensions to the
RISC-V Instruction Set Architecture.</p>
</div>
<div class="paragraph">
<p>This document is <em>Ratified</em>.
No changes are allowed. Any desired or needed changes can be the
subject of a follow-on new extension. Ratified extensions are never
revised.
For more information, see <a href="http://riscv.org/spec-state">here</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Copyright and licensure:</div>
This work is licensed under a
<a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Document Version Information:</div>
<div class="paragraph">
<p>main
@
ef1eeb9074e57d4e08d77d3db43dc345e354bc7f</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/riscv/riscv-crypto">github.com/riscv/riscv-crypto</a>
for more information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgments">Acknowledgments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Contributors to this specification (in alphabetical order)
include:<br>
Allen Baum,
Barna Ibrahim,
Barry Spinney,
Ben Marshall,
Derek Atkins,
<a href="mailto:kdockser@tenstorrent.com">Ken Dockser</a> (Editor),
Markku-Juhani O. Saarinen,
Nicolas Brunie,
Richard Newell</p>
</div>
<div class="paragraph">
<p>We are all very grateful to the many other people who have
helped to improve this specification through their comments, reviews,
feedback and questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crypto_vector_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the proposed <em>vector</em> cryptography
extensions for RISC-V.
All instructions proposed here are based on the Vector registers.
The instructions are designed to be highly performant, with large
application and server-class cores being the main target.
A companion document <em>Volume I: Scalar &amp; Entropy Source Instructions</em>,
describes
cryptographic instruction proposals for smaller cores which do not
implement the vector extension.</p>
</div>
<div class="sect2">
<h3 id="crypto_vector_audience">1.1. Intended Audience</h3>
<div class="paragraph">
<p>Cryptography is a specialized subject, requiring people with many different
backgrounds to cooperate in its secure and efficient implementation.
Where possible, we have written this specification to be understandable by
all, though we recognize that the motivations and references to
algorithms or other specifications and standards may be unfamiliar to those
who are not domain experts.</p>
</div>
<div class="paragraph">
<p>This specification anticipates being read and acted on by various people
with different backgrounds.
We have tried to capture these backgrounds
here, with a brief explanation of what we expect them to know, and how
it relates to the specification.
We hope this aids people&#8217;s understanding of which aspects of the specification
are particularly relevant to them, and which they may (safely!) ignore or
pass to a colleague.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Cryptographers and cryptographic software developers</dt>
<dd>
<p>These are the people we expect to write code using the instructions
in this specification.
They should understand the motivations for the
instructions we include, and be familiar with most of the algorithms
and outside standards to which we refer.</p>
</dd>
<dt class="hdlist1">Computer architects</dt>
<dd>
<p>We do not expect architects to have a cryptography background.
We nonetheless expect architects to be able to examine our instructions
for implementation issues, understand how the instructions will be used
in context, and advise on how best to fit the functionality the
cryptographers want.</p>
</dd>
<dt class="hdlist1">Digital design engineers &amp; micro-architects</dt>
<dd>
<p>These are the people who will implement the specification inside a
core. Again, no cryptography expertise is assumed, but we expect them to
interpret the specification and anticipate any hardware implementation
issues, e.g., where high-frequency design considerations apply, or where
latency/area tradeoffs exist etc.
In particular, they should be aware of the literature around efficiently
implementing AES and SM4 SBoxes in hardware.</p>
</dd>
<dt class="hdlist1">Verification engineers</dt>
<dd>
<p>These people are responsible for ensuring the correct implementation of the
extensions in hardware.
No cryptography background is assumed.
We expect them to identify interesting test cases from the
specification. An understanding of their real-world usage will help with this.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These are by no means the only people concerned with the specification,
but they are the ones we considered most while writing it.</p>
</div>
</div>
<div class="sect2">
<h3 id="crypto_vector_sail_specifications">1.2. Sail Specifications</h3>
<div class="paragraph">
<p>RISC-V maintains a
<a href="https://github.com/riscv/sail-riscv">formal model</a>
of the ISA specification,
implemented in the Sail ISA specification language
cite:[sail].
Note that <em>Sail</em> refers to the specification language itself,
and that there is a <em>model of RISC-V</em>, written using Sail.</p>
</div>
<div class="paragraph">
<p>It was our intention to include actual Sail code in this specification.
However, the Vector Crypto Sail model needs the Vector Sail model as a
basis on which to build. This Vector Cryptography extensions specification
was completed before there was an approved RISC-V Vector Sail Model.
Therefore, we don&#8217;t have any Sail code to include in the instruction
descriptions. Instead we have included Sail-like pseudo code. While we have
endeavored to adhere to Sail syntax, we have taken some liberties for the
sake of simplicity where we believe that that our intent is clear to the
reader.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Where variables are concatenated, the order shown is how they would appear
in a vector register from left to right.
For example, an element group specified as <code>{a, b, e, f}</code> would appear in a vector
register with <code>a</code> having the highest element index of the group and <code>f</code> having the
lowest index of the group.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the sake of brevity, our pseudo code does not include the handling of
masks or tail elements. We follow the <em>undisturbed</em> and <em>agnostic</em> policies
for masks and tails  as described in the <strong>RISC-V "V" Vector Extension</strong>
specification. Furthermore, the code does not explicitly handle overlap and SEW
constraints; these are, however, explicitly stated in the text.</p>
</div>
<div class="paragraph">
<p>In many cases the pseudo code includes
calls to supporting functions which are too verbose to include directly
in the specification.
This supporting code is listed in
<a href="#crypto_vector_appx_sail">Appendix C</a>.</p>
</div>
<div class="paragraph">
<p>The
<a href="https://github.com/rems-project/sail/blob/sail2/manual.pdf">Sail Manual</a>
is recommended reading in order to best understand the code snippets.
Also, the
<a href="https://github.com/billmcspadden-riscv/sail/blob/cookbook_br/cookbook/doc/TheSailCookbook_Complete.pdf">The Sail Programming Language: A Sail Cookbook</a>
is a good reference that is in the process of being written.</p>
</div>
<div class="paragraph">
<p>For the latest RISC-V Sail model, refer to
the formal model Github
<a href="https://github.com/riscv/sail-riscv">repository</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="crypto_vector_policies">1.3. Policies</h3>
<div class="paragraph">
<p>In creating this proposal, we tried to adhere to the following
policies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where there is a choice between:
1) supporting diverse implementation strategies for an algorithm
or
2) supporting a single implementation style which is more performant /
   less expensive;
the vector crypto extensions will pick the more constrained but performant
option.
This fits a common pattern in other parts of the RISC-V specifications,
where recommended (but not required) instruction sequences for performing
particular tasks are given as an example, such that both hardware and
software implementers can optimize for only a single use-case.</p>
</li>
<li>
<p>The extensions will be designed to support <em>existing</em> standardized
cryptographic constructs well.
It will not try to support proposed standards, or cryptographic
constructs which exist only in academia.
Cryptographic standards which are settled upon concurrently with or after
the RISC-V vector cryptographic extensions standardization will be dealt with
by future RISC-V vector cryptographic
standard extensions.</p>
</li>
<li>
<p>Historically, there has been some discussion
cite:[LSYRR:04]
on how newly supported operations in general-purpose computing might
enable new bases for cryptographic algorithms.
The standard will not try to anticipate new useful low-level
operations which <em>may</em> be useful as building blocks for
future cryptographic constructs.</p>
</li>
<li>
<p>Regarding side-channel countermeasures:
Where relevant, proposed instructions must aim to remove the
possibility of any timing side-channels. All instructions
shall be implemented with data-independent timing. That is, the latency of
the execution of these instructions shall not vary with different input values.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="crypto-vector-element-groups">1.4. Element Groups</h3>
<div class="paragraph">
<p>Many vector crypto instructions operate on operands that are wider than elements (which are currently limited
to 64 bits wide).
Typically, these operands are 128- and 256-bits wide. In many cases, these operands are comprised of smaller
operands that are combined (for example, each SHA-2 operand is comprised of 4 words). However, in other cases
these operands are a single value (for example, in the AES round instructions, each operand is 128-bit block
or round key).</p>
</div>
<div class="paragraph">
<p>We treat these operands as a vector of one or more <em>element groups</em> as defined in the
<a href="https://github.com/riscv/riscv-v-spec/blob/master/element_groups.adoc">RISC-V Vector Element Groups</a>
specification.</p>
</div>
<div class="paragraph">
<p>Each vector crypto instruction that operates on element groups explicitly specifies their three defining
parameters: EGW, EGS, and EEW.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruction Group</th>
<th class="tableblock halign-left valign-top">Extension</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">EGS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkned">Zvkned</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvknh">zvknh[ab]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvknh">zvknhb</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkg">Zvkg</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SM4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvksed">Zvksed</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SM3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvksh">Zvksh</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Element Group Width (<code>EGW</code>) - total number of bits in an element group</p>
</li>
<li>
<p>Effective Element Width (<code>EEW</code>) - number of bits in each element</p>
</li>
<li>
<p>Element Group Size (<code>EGS</code>) - number of elements in an element group</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For all of the vector crypto instructions in this specification, <code>EEW</code>=<code>SEW</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The required <code>SEW</code> for each cryptographic instruction was chosen to match what is
typically needed for other instructions when implementing the targeted algorithm.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>Vector Element Group</strong> is a vector of one or more element groups.</p>
</li>
<li>
<p>A <strong>Scalar Element Group</strong> is a single element group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Element groups can be formed across registers in implementations where
<code>VLEN</code>&lt; <code>EGW</code> by using an <code>LMUL</code>&gt;1.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the the <strong>vector extension for application processors</strong> requires a minimum of VLEN of 128,
at most such implementations would require LMUL=2 to form the largest element groups in this specification.</p>
</div>
<div class="paragraph">
<p>However, implementations with a smaller VLEN, such as embedded designs, will requires a larger <code>LMUL</code>
to form the necessary element groups.
It is important to keep in mind that this reduces the number of register groups available such
that it may be difficult or impossible to write efficient code for the intended cryptographic algorithms.</p>
</div>
<div class="paragraph">
<p>For example, an implementation with <code>VLEN</code>=32 would need to set <code>LMUL</code>=8 to create a
256-bit element group for <code>SM3</code>. This would mean that there would only be 4 register groups,
3 of which would be consumed by a single <code>SM3</code> message-expansion instruction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As with all vector instructions, the number of elements processed is specified by the
vector length <code>vl</code>. The number of element groups operated upon is then <code>vl</code>/<code>EGS</code>.
Likewise the starting element group is <code>vstart</code>/<code>EGS</code>.
See <a href="#crypto-vector-instruction-constraints">Section 1.5</a> for limitations on <code>vl</code> and <code>vstart</code>
for vector crypto instructions.</p>
</div>
</div>
<div class="sect2">
<h3 id="crypto-vector-instruction-constraints">1.5. Instruction Constraints</h3>
<div class="paragraph">
<p>The following is a quick reference for the various constraints of specific Vector Crypto instructions.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">vl and vstart constraints</dt>
<dd>
<p>Since <code>vl</code> and <code>vstart</code> refer to elements, Vector Crypto instructions that use elements groups
(See <a href="#crypto-vector-element-groups">Section 1.4</a>) require that these values are an integer multiple of the
Element Group Size (<code>EGS</code>).</p>
<div class="ulist">
<ul>
<li>
<p>Instructions that violate the <code>vl</code> or <code>vstart</code> requirements are <em>reserved</em>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instructions</th>
<th class="tableblock halign-left valign-top">EGS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaes*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vg*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">LMUL constraints</dt>
<dd>
<p>For element-group instructions, <code>LMUL</code>*<code>VLEN</code> must always be at least as large as <code>EGW</code>, otherwise an
<em>illegal instruction exception</em> is raised, even if <code>vl</code>=0.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instructions</th>
<th class="tableblock halign-left valign-top">SEW</th>
<th class="tableblock halign-left valign-top">EGW</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaes*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vg*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">SEW constraints</dt>
<dd>
<p>Some Vector Crypto instructions are only defined for a specific <code>SEW</code>. In such a case
all other <code>SEW</code> values are <em>reserved</em>.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instructions</th>
<th class="tableblock halign-left valign-top">Required SEW</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaes*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zvknha: vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zvknhb: vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 or 64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vclmul[h]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vg*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Source/Destination overlap constraints</dt>
<dd>
<p>Some Vector Crypto instructions have overlap constraints. Encodings that violate these constraints are <em>reserved</em>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In the case of the <code>.vs</code> instructions defined in this specification, <code>vs2</code> holds a 128-bit scalar element group.
For implementations with <code>VLEN</code> ≥ 128, <code>vs2</code> refers to a single register. Thus, the <code>vd</code> register group must not
overlap the <code>vs2</code> register.
However, in implementations where <code>VLEN</code> &lt; 128, <code>vs2</code> refers to a register group comprised of the number
of registers needed to hold the 128-bit scalar element group. In this case, the <code>vd</code> register group must not
overlap this <code>vs2</code> register group.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Instruction</th>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Cannot Overlap</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaes*.vs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4r.vs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2c[hl]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs1, vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs1, vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sm3me</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="crypto-vector-scalar-instructions">1.6. Vector-Scalar Instructions</h3>
<div class="paragraph">
<p>The RISC-V Vector Extension defines three encodings for Vector-Scalar operations which get their scalar operand from a GPR or FP register:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OPIVX: Scalar GPR <em>x</em> register</p>
</li>
<li>
<p>OPFVF: Scalar FP <em>f</em> register</p>
</li>
<li>
<p>OPMVX: Scalar GPR <em>x</em> register</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, the Vector Extensions include Vector Reduction Operations which can also be considered
Vector-Scalar operations because a scalar operand is provided from element 0 of
vector register <code>vs1</code>. The vector operand is provided in vector register group <code>vs2</code>.
These reduction operations all use the <code>.vs</code> suffix in their mnemonics. Additionally, the reduction operations all produce a scalar result in element 0 of the destination register, <code>vd</code>.</p>
</div>
<div class="paragraph">
<p>The Vector Crypto Extensions define Vector-Scalar instructions that are similar to these
Vector Reduction Operations in that they get a scalar operand from a vector register. However, they differ
in that they get a scalar element group
(see <a href="#crypto-vector-element-groups">Section 1.4</a>)
from <code>vs2</code> and they return <em>vector</em> results to <code>vd</code>, which is also a source vector operand.
These Vector-Scalar crypto instructions also use the <code>.vs</code> suffix in their mnemonics.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We chose to use <code>vs2</code> as the scalar operand, and <code>vd</code> as the vector operand, so that we could use the <code>vs1</code>
specifier as additional encoding bits for these instructions. This allows these instructions to have a
much smaller encoding footprint, leaving more rooms for other instructions in the future.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These instructions enable a single key, specified as a scalar element group in <code>vs2</code>, to be
applied to each element group of register group <code>vd</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Scalar element groups will occupy at most a single register in application processors. However, in implementations where
VLEN&lt;128, they will occupy 2 (VLEN=64) or 4 (VLEN=32) registers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is common for multiple AES encryption rounds (for example) to be performed in parallel with the same
round key (e.g. in counter modes).
Rather than having to first splat the common key across the whole vector group, these vector-scalar
crypto instructions allow the round key to be specified as a scalar element group.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="crypto-vector-software-portability">1.7. Software Portability</h3>
<div class="paragraph">
<p>The following contains some guidelines that enable the portability of vector-crypto-based code
to implementations with different values for <code>VLEN</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Application Processors</dt>
<dd>
<p>Application processors are expected to follow the V-extension and will therefore have <code>VLEN</code> ≥ 128.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Since most of the <em>cryptography-specific</em> instructions have an <code>EGW</code>=128, nothing special needs to be done
for these instructions to support implementations with <code>VLEN</code>=128.</p>
</div>
<div class="paragraph">
<p>However, the SHA-512 and SM3 instructions have an <code>EGW</code>=256. Implementations with <code>VLEN</code> = 128, require that
<code>LMUL</code> is doubled for these instructions in order to create 256-bit elements across a pair of registers.
Code written with this doubling of <code>LMUL</code> will not affect the results returned by implementations with <code>VLEN</code> ≥ 256
because <code>vl</code> controls how many element groups are processed. Therefore, we recommend that libraries that implement
SHA-512 and SM3 employ this doubling of <code>LMUL</code> to ensure that the software can run on all implementation
with <code>VLEN</code> ≥ 128.</p>
</div>
<div class="paragraph">
<p>While the doubling of <code>LMUL</code> for these instructions is <em>safe</em> for implementations with <code>VLEN</code> ≥ 256, it may be less
optimal as it will result in unnecessary register pressure and might exact a performance penalty in
some microarchitectures. Therefore, we suggest that in addition to providing portable code for SHA-512 and SM3,
libraries should also include more optimal code for these instructions when <code>VLEN</code> ≥ 256.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm</th>
<th class="tableblock halign-left valign-top">Instructions</th>
<th class="tableblock halign-left valign-top">VLEN</th>
<th class="tableblock halign-left valign-top">LMUL</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA-512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl/2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SM3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl/4</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Embedded Processors</dt>
<dd>
<p>Embedded processors will typically have implementations with <code>VLEN</code> &lt; 128. This will require code to be written with
larger <code>LMUL</code> values to enable the element groups to be formed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>.vs</code> instructions require scalar element groups of <code>EGW</code>=128. On implementations with <code>VLEN</code> &lt; 128, these scalar
element groups will necessarily be formed across registers. This is different from most scalars in vector instructions
that typically consume part of a single register.</p>
</div>
<div class="paragraph">
<p>We recommend that different code be available for <code>VLEN</code>=32 and <code>VLEN</code>=64, as code written for <code>VLEN</code>=32 will
likely be too burdensome for <code>VLEN</code>=64 implementations.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crypto_vector_extensions">2. Extensions Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The section introduces all of the  extensions in the Vector Cryptography
Instruction Set Extension Specification.</p>
</div>
<div class="paragraph">
<p>The <a href="#zvknh">Zvknhb</a> and <a href="#zvbc">Zvbc</a> Vector Crypto Extensions
--and accordingly the composite extensions <a href="#zvkn">Zvkn</a> and <a href="#zvks">Zvks</a>--
require a Zve64x base,
or application ("V") base Vector Extension.</p>
</div>
<div class="paragraph">
<p>All of the other Vector Crypto Extensions can be built
on <em>any</em> embedded (Zve*) or application ("V") base Vector Extension.</p>
</div>
<div class="paragraph">
<p>All <em>cryptography-specific</em> instructions defined in this Vector Crypto specification (i.e., those
in <a href="#zvkned">Zvkned</a>, <a href="#zvknh">Zvknh[ab]</a>, <a href="#zvkg">Zvkg</a>, <a href="#zvksed">Zvksed</a> and <a href="#zvksh">Zvksh</a> but <em>not</em> <a href="#zvbb">Zvbb</a>,<a href="#zvkb">Zvkb</a>, or <a href="#zvbc">Zvbc</a>) shall
be executed with data-independent execution latency as defined in the
<a href="https://github.com/riscv/riscv-crypto/releases/tag/v1.0.1-scalar">RISC-V Scalar Cryptography Extensions specification</a>.
It is important to note that the Vector Crypto instructions are independent of the
implementation of the <code>Zkt</code> extension and do not require that <code>Zkt</code> is implemented.</p>
</div>
<div class="paragraph">
<p>This specification includes a <a href="#zvkt">Zvkt</a> extension that, when implemented, requires certain vector instructions
(including <a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, and <a href="#zvbc">Zvbc</a>) to be executed with data-independent execution latency.</p>
</div>
<div class="paragraph">
<p>Detection of individual cryptography extensions uses the
unified software-based RISC-V discovery method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At the time of writing, these discovery mechanisms are still a work in
progress.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="zvbb">2.1. <code>Zvbb</code> - Vector Basic Bit-manipulation</h3>
<div class="paragraph">
<p>Vector basic bit-manipulation instructions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This extension is a superset of the <a href="#zvkb">Zvkb</a> extension.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vandn.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vandn">Vector And-Not</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbrev.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vbrev">Vector Reverse Bits in Elements</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbrev8.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vbrev8">Vector Reverse Bits in Bytes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrev8.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vrev8">Vector Reverse Bytes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vclz.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vclz">Vector Count Leading Zeros</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vctz.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vctz">Vector Count Trailing Zeros</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vcpop.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vcpop">Vector Population Count</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrol.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vrol">Vector Rotate Left</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vror.[vv,vx,vi]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vror">Vector Rotate Right</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsll.[vv,vx,vi]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vwsll">Vector Widening Shift Left Logical</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvbc">2.2. <code>Zvbc</code> - Vector Carryless Multiplication</h3>
<div class="paragraph">
<p>General purpose carryless multiplication instructions which are commonly used in cryptography
and hashing (e.g., Elliptic curve cryptography, GHASH, CRC).</p>
</div>
<div class="paragraph">
<p>These instructions are only defined for <code>SEW</code>=64.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">vclmul.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vclmul">Vector Carry-less Multiply</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">vclmulh.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vclmulh">Vector Carry-less Multiply Return High Half</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkb">2.3. <code>Zvkb</code> - Vector Cryptography Bit-manipulation</h3>
<div class="paragraph">
<p>Vector bit-manipulation instructions that are essential
for implementing common cryptographic workloads securely &amp;
efficiently.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This Zvkb extension is a proper subset of the Zvbb extension.
Zvkb allows for vector crypto implementations without incuring
the the cost of implementing the additional bitmanip instructions
in the Zvbb extension: vbrev.v, vclz.v, vctz.v, vcpop.v, and vwsll.[vv,vx,vi].</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vandn.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vandn">Vector And-Not</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbrev8.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vbrev8">Vector Reverse Bits in Bytes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrev8.v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vrev8">Vector Reverse Bytes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrol.[vv,vx]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vrol">Vector Rotate Left</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vror.[vv,vx,vi]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vror">Vector Rotate Right</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkg">2.4. <code>Zvkg</code> - Vector GCM/GMAC</h3>
<div class="paragraph">
<p>Instructions to enable the efficient implementation of GHASH<sub>H</sub> which is used in Galois/Counter Mode (GCM) and
Galois Message Authentication Code (GMAC).</p>
</div>
<div class="paragraph">
<p>All of these instructions work on 128-bit element groups comprised of four 32-bit elements.</p>
</div>
<div class="paragraph">
<p>GHASH<sub>H</sub> is defined in the
 "Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"
 cite:[nist:gcm]
(NIST Specification).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>GCM is used in conjunction with block ciphers (e.g., AES and SM4) to encrypt a message and
provide authentication.
GMAC is used to provide authentication of a message without encryption.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To help avoid side-channel timing attacks, these instructions shall be implemented with data-independent timing.</p>
</div>
<div class="paragraph">
<p>The number of element groups to be processed is <code>vl</code>/<code>EGS</code>.
<code>vl</code> must be set to the number of <code>SEW=32</code> elements to be processed and
therefore must be a multiple of <code>EGS=4</code>.<br>
Likewise, <code>vstart</code> must be a multiple of <code>EGS=4</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">SEW</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vghsh.vv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vghsh">Vector GHASH Add-Multiply</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vgmul.vv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vgmul">Vector GHASH Multiply</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkned">2.5. <code>Zvkned</code> - NIST Suite: Vector AES Block Cipher</h3>
<div class="paragraph">
<p>Instructions for accelerating
encryption, decryption and key-schedule
functions of the AES block cipher as defined in
Federal Information Processing Standards Publication 197
cite:[nist:fips:197]</p>
</div>
<div class="paragraph">
<p>All of these instructions work on 128-bit element groups comprised of four
32-bit elements.</p>
</div>
<div class="paragraph">
<p>For the best performance, it is suggested that these instruction be implemented on systems with <code>VLEN</code>&gt;=128.
On systems with <code>VLEN</code>&lt;128, element groups may be formed by concatenating 32-bit elements
from two or four registers by using an LMUL =2 and LMUL=4 respectively.</p>
</div>
<div class="paragraph">
<p>To help avoid side-channel timing attacks, these instructions shall be implemented with data-independent timing.</p>
</div>
<div class="paragraph">
<p>The number of element groups to be processed is <code>vl</code>/<code>EGS</code>.
<code>vl</code> must be set to the number of <code>SEW=32</code> elements to be processed and
therefore must be a multiple of <code>EGS=4</code>.<br>
Likewise, <code>vstart</code> must be a multiple of <code>EGS=4</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">SEW</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesef.[vv,vs]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaesef">Vector AES encrypt final round</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesem.[vv,vs]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaesem">Vector AES encrypt middle round</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesdf.[vv,vs]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaesdf">Vector AES decrypt final round</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesdm.[vv,vs]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaesdm">Vector AES decrypt middle round</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaeskf1.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaeskf1">Vector AES-128 Forward KeySchedule</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaeskf2.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaeskf2">Vector AES-256 Forward KeySchedule</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesz.vs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vaesz">Vector AES round zero</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvknh">2.6. <code>Zvknh[ab]</code> - NIST Suite: Vector SHA-2 Secure Hash</h3>
<div class="paragraph">
<p>Instructions for accelerating SHA-2 as defined in FIPS PUB 180-4 Secure Hash Standard (SHS)
cite:[nist:fips:180:4]</p>
</div>
<div class="paragraph">
<p><code>SEW</code> differentiates between SHA-256 (<code>SEW</code>=32) and SHA-512 (<code>SEW</code>=64).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SHA-256: these instructions work on 128-bit element groups comprised of four 32-bit elements.</p>
</li>
<li>
<p>SHA-512: these instructions work on 256-bit element groups comprised of four 64-bit elements.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">SEW</th>
<th class="tableblock halign-center valign-top">EGW</th>
<th class="tableblock halign-center valign-top">SHA-2</th>
<th class="tableblock halign-left valign-top">Extension</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SHA-256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zvknha, Zvknhb</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">SHA-512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zvknhb</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>Zvknhb supports SHA-256 and SHA-512.</p>
</li>
<li>
<p>Zvknha supports only SHA-256.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SHA-256 implementations with VLEN &lt; 128 require LMUL&gt;1 to combine
32-bit elements from register groups to provide all four elements of the element group.</p>
</div>
<div class="paragraph">
<p>SHA-512 implementations with VLEN &lt; 256 require LMUL&gt;1 to combine
64-bit elements from register groups to provide all four elements of the element group.</p>
</div>
<div class="paragraph">
<p>To help avoid side-channel timing attacks, these instructions shall be implemented with data-independent timing.</p>
</div>
<div class="paragraph">
<p>The number of element groups to be processed is <code>vl</code>/<code>EGS</code>.
<code>vl</code> must be set to the number of <code>SEW</code> elements to be processed and
therefore must be a multiple of <code>EGS=4</code>.<br>
Likewise, <code>vstart</code> must be a multiple of <code>EGS=4</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2ms.vv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsha2ms">Vector SHA-2 Message Schedule</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2c[hl].vv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsha2c">Vector SHA-2 Compression</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvksed">2.7. <code>Zvksed</code> - ShangMi Suite: SM4 Block Cipher</h3>
<div class="paragraph">
<p>Instructions for accelerating
encryption, decryption and key-schedule
functions of the SM4 block cipher.</p>
</div>
<div class="paragraph">
<p>The SM4 block cipher is specified in <em>32907-2016: {SM4} Block Cipher Algorithm</em>
cite:[gbt:sm4]</p>
</div>
<div class="paragraph">
<p>There are other various sources available that describe the SM4 block cipher.
While not the final version of the standard,
<a href="https://www.rfc-editor.org/rfc/rfc8998.html">RFC 8998 ShangMi (SM) Cipher Suites for TLS 1.3</a>
is useful and easy to access.</p>
</div>
<div class="paragraph">
<p>All of these instructions work on 128-bit element groups comprised of four
32-bit elements.</p>
</div>
<div class="paragraph">
<p>To help avoid side-channel timing attacks, these instructions shall be implemented with data-independent timing.</p>
</div>
<div class="paragraph">
<p>The number of element groups to be processed is <code>vl</code>/<code>EGS</code>.
<code>vl</code> must be set to the number of <code>SEW=32</code> elements to be processed and
therefore must be a multiple of <code>EGS=4</code>.<br>
Likewise, <code>vstart</code> must be a multiple of <code>EGS=4</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">SEW</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4k.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsm4k">Vector SM4 Key Expansion</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4r.[vv,vs]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsm4r">SM4 Block Cipher Rounds</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvksh">2.8. <code>Zvksh</code> - ShangMi Suite: SM3 Secure Hash</h3>
<div class="paragraph">
<p>Instructions for accelerating
functions of the SM3 Hash Function.</p>
</div>
<div class="paragraph">
<p>The SM3 secure hash algorithm is specified in <em>32905-2016: SM3 Cryptographic Hash Algorithm</em>
cite:[gbt:sm4]</p>
</div>
<div class="paragraph">
<p>There are other various sources available that describe the SM3 secure hash.
While not the final version of the standard,
<a href="https://www.rfc-editor.org/rfc/rfc8998.html">RFC 8998 ShangMi (SM) Cipher Suites for TLS 1.3</a>
is useful and easy to access.</p>
</div>
<div class="paragraph">
<p>All of these instructions work on 256-bit element groups comprised of
eight 32-bit elements.</p>
</div>
<div class="paragraph">
<p>Implementations with VLEN &lt; 256 require LMUL&gt;1 to combine 32-bit elements from register groups
to provide all eight elements of the element group.</p>
</div>
<div class="paragraph">
<p>To help avoid side-channel timing attacks, these instructions shall be implemented with data-independent timing.</p>
</div>
<div class="paragraph">
<p>The number of element groups to be processed is <code>vl</code>/<code>EGS</code>.
<code>vl</code> must be set to the number of <code>SEW=32</code> elements to be processed and
therefore must be a multiple of <code>EGS=8</code>.<br>
Likewise, <code>vstart</code> must be a multiple of <code>EGS=8</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SEW</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3me.vv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsm3me">SM3 Message Expansion</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3c.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#insns-vsm3c">SM3 Compression</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkn">2.9. <code>Zvkn</code> - NIST Algorithm Suite</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkned</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkned">Zvkned</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvknhb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvknh">Zvknhb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkb">Zvkb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkt">Zvkt</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While Zvkg and Zvbc are not part of this extension, it is recommended that at least one of them is implemented with this extension to enable efficient AES-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvknc">2.10. <code>Zvknc</code> - NIST Algorithm Suite with carryless multiply</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkn">Zvkn</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvbc">Zvbc</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This extension combines the NIST Algorithm Suite with the
vector carryless multiply extension to enable AES-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkng">2.11. <code>Zvkng</code> - NIST Algorithm Suite with GCM</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkn">Zvkn</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkg">Zvkg</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This extension combines the NIST Algorithm Suite with the
GCM/GMAC extension to enable high-performace AES-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvks">2.12. <code>Zvks</code> - ShangMi Algorithm Suite</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvksed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvksed">Zvksed</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvksh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvksh">Zvksh</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkb">Zvkb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkt">Zvkt</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While Zvkg and Zvbc are not part of this extension, it is recommended that at least one of them is implemented with this extension to enable efficient SM4-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvksc">2.13. <code>Zvksc</code> - ShangMi Algorithm Suite with carryless multiplication</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvks">Zvks</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvbc">Zvbc</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This extension combines the ShangMi Algorithm Suite with the
vector carryless multiply extension to enable SM4-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvksg">2.14. <code>Zvksg</code> - ShangMi Algorithm Suite with GCM</h3>
<div class="paragraph">
<p>This extension is shorthand for the following set of other extensions:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Included Extension</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvks">Zvks</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Zvkg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#zvkg">Zvkg</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This extension combines the ShangMi Algorithm Suite with the
GCM/GMAC extension to enable high-performace SM4-GCM.</p>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="zvkt">2.15. <code>Zvkt</code> - Vector Data-Independent Execution Latency</h3>
<div class="paragraph">
<p>The Zvkt extension requires all implemented instructions from the following list to be
executed with data-independent execution latency as defined in the
<a href="https://github.com/riscv/riscv-crypto/releases/tag/v1.0.1-scalar">RISC-V Scalar Cryptography Extensions specification</a>.</p>
</div>
<div class="paragraph">
<p>Data-independent execution latency (DIEL) applies to all <em>data operands</em> of an instruction, even those that are not a
part of the body or that are inactive. However, DIEL does not apply
to other values such as vl, vtype, and the mask (when used to control
execution of a masked vector instruction).
Also, DIEL does not apply to constant values specified in the
instruction encoding such as the use of the zero register (<code>x0</code>), and, in the
case of immediate forms of an instruction, the values in the immediate
fields (i.e., imm, and uimm).</p>
</div>
<div class="paragraph">
<p>In some cases --- which are explicitly specified in the lists below
--- operands that are used as control rather than data
are exempt from DIEL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DIEL helps protect against side-channel timing attacks that are used
to determine data values that are intended to be kept secret. Such
values include cryptographic keys, plain text, and partially encrypted
text. DIEL is not intended to keep software (and cryptographic
algorithms contained therein) secret as it is assumed that an adversary
would already know these. This is why DIEL doesn&#8217;t apply to constants
embedded in instruction encodings.</p>
</div>
<div class="paragraph">
<p>It is important that the <em>values</em> of elements that are not in the body or that are masked off do not affect the execution
latency of the instruction. Sometimes such elements contain data that
also needs to be kept secret.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_all_zvbb_instructions">2.15.1. All <a href="#zvbb">Zvbb</a>  instructions:</h4>
<div class="ulist">
<ul>
<li>
<p>vandn.v[vx]</p>
</li>
<li>
<p>vclz.v</p>
</li>
<li>
<p>vcpop.v</p>
</li>
<li>
<p>vctz.v</p>
</li>
<li>
<p>vbrev.v</p>
</li>
<li>
<p>vbrev8.v</p>
</li>
<li>
<p>vrev8.v</p>
</li>
<li>
<p>vrol.v[vx]</p>
</li>
<li>
<p>vror.v[vxi]</p>
</li>
<li>
<p>vwsll.[vv,vx,vi]</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All <a href="#zvkb">Zvkb</a> instructions are also covered by DIEL as they are a
proper subset of <a href="#zvbb">Zvbb</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_all_zvbc_instructions">2.15.2. All <a href="#zvbc">Zvbc</a> instructions</h4>
<div class="ulist">
<ul>
<li>
<p>vclmul[h].v[vx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_addsub">2.15.3. add/sub</h4>
<div class="ulist">
<ul>
<li>
<p>v[r]sub.v[vx]</p>
</li>
<li>
<p>vadd.v[ivx]</p>
</li>
<li>
<p>vsub.v[vx]</p>
</li>
<li>
<p>vwadd[u].[vw][vx]</p>
</li>
<li>
<p>vwsub[u].[vw][vx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_addsub_with_carry">2.15.4. add/sub with carry</h4>
<div class="ulist">
<ul>
<li>
<p>vadc.v[ivx]m</p>
</li>
<li>
<p>vmadc.v[ivx][m]</p>
</li>
<li>
<p>vmsbc.v[vx]m</p>
</li>
<li>
<p>vsbc.v[vx]m</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_compare_and_set">2.15.5. compare and set</h4>
<div class="ulist">
<ul>
<li>
<p>vmseq.v[vxi]</p>
</li>
<li>
<p>vmsgt[u].v[xi]</p>
</li>
<li>
<p>vmsle[u].v[xi]</p>
</li>
<li>
<p>vmslt[u].v[xi]</p>
</li>
<li>
<p>vmsne.v[ivx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_copy">2.15.6. copy</h4>
<div class="ulist">
<ul>
<li>
<p>vmv.s.x</p>
</li>
<li>
<p>vmv.v.[ivxs]</p>
</li>
<li>
<p>vmv[1248]r.v</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_extend">2.15.7. extend</h4>
<div class="ulist">
<ul>
<li>
<p>vsext.vf[248]</p>
</li>
<li>
<p>vzext.vf[248]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_logical">2.15.8. logical</h4>
<div class="ulist">
<ul>
<li>
<p>vand.v[ivx]</p>
</li>
<li>
<p>vm[n]or.mm</p>
</li>
<li>
<p>vmand[n].mm</p>
</li>
<li>
<p>vmnand.mm</p>
</li>
<li>
<p>vmorn.mm</p>
</li>
<li>
<p>vmx[n]or.mm</p>
</li>
<li>
<p>vor.v[ivx]</p>
</li>
<li>
<p>vxor.v[ivx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_multiply">2.15.9. multiply</h4>
<div class="ulist">
<ul>
<li>
<p>vmul[h].v[vx]</p>
</li>
<li>
<p>vmulh[s]u.v[vx]</p>
</li>
<li>
<p>vwmul.v[vx]</p>
</li>
<li>
<p>vwmul[s]u.v[vx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_multiply_add">2.15.10. multiply-add</h4>
<div class="ulist">
<ul>
<li>
<p>vmacc.v[vx]</p>
</li>
<li>
<p>vmadd.v[vx]</p>
</li>
<li>
<p>vnmsac.v[vx]</p>
</li>
<li>
<p>vnmsub.v[vx]</p>
</li>
<li>
<p>vwmacc.v[vx]</p>
</li>
<li>
<p>vwmacc[s]u.v[vx]</p>
</li>
<li>
<p>vwmaccus.vx</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_integer_merge">2.15.11. Integer Merge</h4>
<div class="ulist">
<ul>
<li>
<p>vmerge.v[ivx]m</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_permute">2.15.12. permute</h4>
<div class="paragraph">
<p>In the <code>.vv</code> and <code>.xv</code> forms of the <code>vragather[ei16]</code> instructions,
the values in <code>vs1</code> and <code>rs1</code> are used for control and therefore are exempt from DIEL.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>vrgather.v[ivx]</p>
</li>
<li>
<p>vrgatherei16.vv</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_shift">2.15.13. shift</h4>
<div class="ulist">
<ul>
<li>
<p>vnsr[al].w[ivx]</p>
</li>
<li>
<p>vsll.v[ivx]</p>
</li>
<li>
<p>vsr[al].v[ivx]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_slide">2.15.14. slide</h4>
<div class="ulist">
<ul>
<li>
<p>vslide1[up|down].vx</p>
</li>
<li>
<p>vfslide1[up|down].vf</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the vslide[up|down].vx instructions, the value in <code>rs1</code>
is used for control (i.e., slide amount) and therefore is exempt
from DIEL.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>vslide[up|down].v[ix]</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following instructions are not affected by Zvkt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>All storage operations</strong></p>
</li>
<li>
<p><strong>All floating-point operations</strong></p>
</li>
<li>
<p>add/sub saturate</p>
<div class="ulist">
<ul>
<li>
<p>vsadd[u].v[ivx]</p>
</li>
<li>
<p>vssub[u].v[vx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>clip</p>
<div class="ulist">
<ul>
<li>
<p>vnclip[u].w[ivx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>compress</p>
<div class="ulist">
<ul>
<li>
<p>vcompress.vm</p>
</li>
</ul>
</div>
</li>
<li>
<p>divide</p>
<div class="ulist">
<ul>
<li>
<p>vdiv[u].v[vx]</p>
</li>
<li>
<p>vrem[u].v[vx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>average</p>
<div class="ulist">
<ul>
<li>
<p>vaadd[u].v[vx]</p>
</li>
<li>
<p>vasub[u].v[vx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>mask Op</p>
<div class="ulist">
<ul>
<li>
<p>vcpop.m</p>
</li>
<li>
<p>vfirst.m</p>
</li>
<li>
<p>vid.v</p>
</li>
<li>
<p>viota.m</p>
</li>
<li>
<p>vms[bio]f.m</p>
</li>
</ul>
</div>
</li>
<li>
<p>min/max</p>
<div class="ulist">
<ul>
<li>
<p>vmax[u].v[vx]</p>
</li>
<li>
<p>vmin[u].v[vx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>Multiply-saturate</p>
<div class="ulist">
<ul>
<li>
<p>vsmul.v[vx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>reduce</p>
<div class="ulist">
<ul>
<li>
<p>vredsum.vs</p>
</li>
<li>
<p>vwredsum[u].vs</p>
</li>
<li>
<p>vred[and|or|xor].vs</p>
</li>
<li>
<p>vred[min|max][u].vs</p>
</li>
</ul>
</div>
</li>
<li>
<p>shift round</p>
<div class="ulist">
<ul>
<li>
<p>vssra.v[ivx]</p>
</li>
<li>
<p>vssrl.v[ivx]</p>
</li>
</ul>
</div>
</li>
<li>
<p>vset</p>
<div class="ulist">
<ul>
<li>
<p>vsetivli</p>
</li>
<li>
<p>vsetvl[i]</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crypto_vector_insns">3. Instructions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="insns-vaesdf">3.1. vaesdf.[vv,vs]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES final-round decryption</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaesdf.vv vd, vs2<br>
vaesdf.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00001'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00001'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001`'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>Only for the <code>.vs</code> form: the <code>vd</code> register group overlaps the <code>vs2</code> scalar element group</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new round state</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A final-round AES block cipher decryption is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The InvShiftRows and InvSubBytes steps are applied to each round state element group from <code>vd</code>.
This is then XORed with the round key in either the corresponding element group in <code>vs2</code> (vector-vector
form) or scalar element group in <code>vs2</code> (vector-scalar form).</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VAESDF(vs2, vd, suffix)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let keyelem = if suffix == &quot;vv&quot; then i else 0;
    let state : bits(128) = get_velem(vd,  EGW=128, i);
    let rkey  : bits(128) = get_velem(vs2, EGW=128, keyelem);
    let sr    : bits(128) = aes_shift_rows_inv(state);
    let sb    : bits(128) = aes_subbytes_inv(sr);
    let ark   : bits(128) = sb ^ rkey;
    set_velem(vd, EGW=128, i, ark);
  }
  RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaesdm">3.2. vaesdm.[vv,vs]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES middle-round decryption</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaesdm.vv vd, vs2<br>
vaesdm.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00000'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00000'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>Only for the <code>.vs</code> form: the <code>vd</code> register group overlaps the <code>vs2</code> scalar element group</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new round state</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A middle-round AES block cipher decryption is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The InvShiftRows and InvSubBytes steps are applied to each round state element group from <code>vd</code>.
This is then XORed with the round key in either the corresponding element group in <code>vs2</code> (vector-vector
form) or the scalar element group in <code>vs2</code> (vector-scalar form). The result is then applied to the
InvMixColumns step.</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VAESDM(vs2, vd, suffix)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let keyelem = if suffix == &quot;vv&quot; then i else 0;
    let state : bits(128) = get_velem(vd, EGW=128, i);
    let rkey  : bits(128) = get_velem(vs2, EGW=128, keyelem);
    let sr    : bits(128) = aes_shift_rows_inv(state);
    let sb    : bits(128) = aes_subbytes_inv(sr);
    let ark   : bits(128) = sb ^ rkey;
    let mix   : bits(128) = aes_mixcolumns_inv(ark);
    set_velem(vd, EGW=128, i, mix);
  }
  RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaesef">3.3. vaesef.[vv,vs]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES final-round encryption</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaesef.vv vd, vs2<br>
vaesef.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00011'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00011'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>Only for the <code>.vs</code> form: the <code>vd</code> register group overlaps the <code>vs2</code> scalar element group</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new round state</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A final-round encryption function of the AES block cipher is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The SubBytes and ShiftRows steps are applied to each round state element group from <code>vd</code>.
This is then XORed with the round key in either the corresponding element group in <code>vs2</code> (vector-vector
form) or the scalar element group in <code>vs2</code> (vector-scalar form).</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VAESEF(vs2, vd, suffix) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let keyelem = if suffix == &quot;vv&quot; then i else 0;
    let state : bits(128) = get_velem(vd, EGW=128, i);
    let rkey  : bits(128) = get_velem(vs2, EGW=128, keyelem);
    let sb    : bits(128) = aes_subbytes_fwd(state);
    let sr    : bits(128) = aes_shift_rows_fwd(sb);
    let ark   : bits(128) = sr ^ rkey;
    set_velem(vd, EGW=128, i, ark);
  }
  RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaesem">3.4. vaesem.[vv,vs]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES middle-round encryption</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaesem.vv vd, vs2<br>
vaesem.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00010'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00010'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>Only for the <code>.vs</code> form: the <code>vd</code> register group overlaps the <code>vs2</code> scalar element group</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new round state</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A middle-round encryption function of the AES block cipher is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The SubBytes, ShiftRows, and MixColumns steps are applied to each round state element group from <code>vd</code>.
This is then XORed with the round key in either the corresponding  element group in <code>vs2</code> (vector-vector
form) or the scalar element group in <code>vs2</code> (vector-scalar form).</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VAESEM(vs2, vd, suffix)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let keyelem = if suffix == &quot;vv&quot; then i else 0;
    let state : bits(128) = get_velem(vd, EGW=128, i);
    let rkey  : bits(128) = get_velem(vs2, EGW=128, keyelem);
    let sb    : bits(128) = aes_subbytes_fwd(state);
    let sr    : bits(128) = aes_shift_rows_fwd(sb);
    let mix   : bits(128) = aes_mixcolumns_fwd(sr);
    let ark   : bits(128) = mix ^ rkey;
    set_velem(vd, EGW=128, i, ark);
  }
  RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaeskf1">3.5. vaeskf1.vi</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES-128 Forward KeySchedule generation</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaeskf1.vi vd, vs2, uimm</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'uimm'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '100010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uimm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round Number (rnd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next round key</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A single round of the forward AES-128 KeySchedule is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The next round key is generated word by word from the
current round key element group in <code>vs2</code> and the immediately previous word of the
round key. The least significant word is generated using the most significant
word of the current round key as well as a round constant which is selected by
the round number.</p>
</div>
<div class="paragraph">
<p>The round number, which ranges from 1 to 10, comes from <code>uimm[3:0]</code>;
<code>uimm[4]</code> is ignored.
The out-of-range <code>uimm[3:0]</code> values of 0 and 11-15 are mapped to in-range
values by inverting <code>uimm[3]</code>. Thus, 0 maps to 8, and 11-15 maps to 3-7.
The round number is used to specify a round constant which is used in generating
the first round key word.</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We chose to map out-of-range round numbers to in-range values as this allows the instruction&#8217;s
behavior to be fully defined for all values of <code>uimm[4:0]</code> with minimal extra logic.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="Sail"><span></span>function clause execute (VAESKF1(rnd, vd, vs2)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

 // project out-of-range immediates onto in-range values
 if( (unsigned(rnd[3:0]) &gt; 10) | (rnd[3:0] = 0)) then rnd[3] = ~rnd[3]

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  let r : bits(4) = rnd-1;

  foreach (i from eg_start to eg_len-1) {
      let CurrentRoundKey[3:0]  : bits(128)  = get_velem(vs2, EGW=128, i);
      let w[0] : bits(32) = aes_subword_fwd(aes_rotword(CurrentRoundKey[3])) XOR
        aes_decode_rcon(r) XOR CurrentRoundKey[0]
      let w[1] : bits(32) = w[0] XOR CurrentRoundKey[1]
      let w[2] : bits(32) = w[1] XOR CurrentRoundKey[2]
      let w[3] : bits(32) = w[2] XOR CurrentRoundKey[3]
      set_velem(vd, EGW=128, i, w[3:0]);
    }
    RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaeskf2">3.6. vaeskf2.vi</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES-256 Forward KeySchedule generation</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaeskf2.vi vd, vs2, uimm</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'uimm'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Previous Round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uimm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round Number (rnd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current Round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next round key</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A single round of the forward AES-256 KeySchedule is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The next round key is generated word by word from the
previous round key element group in <code>vd</code> and the immediately previous word of the
round key. The least significant word of the next round key is generated by
applying a function to the most significant word of the current round key and
then XORing the result with the round constant.
The round number is used to select the round constant as well as the function.</p>
</div>
<div class="paragraph">
<p>The round number, which ranges from 2 to 14, comes from <code>uimm[3:0]</code>;
<code>uimm[4]</code> is ignored.
The out-of-range <code>uimm[3:0]</code> values of 0-1 and 15 are mapped to in-range
values by inverting <code>uimm[3]</code>. Thus, 0-1 maps to 8-9, and 15 maps to 7.</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We chose to map out-of-range round numbers to in-range values as this allows the instruction&#8217;s
behavior to be fully defined for all values of <code>uimm[4:0]</code> with minimal extra logic.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="Sail"><span></span>function clause execute (VAESKF2(rnd, vd, vs2)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

 // project out-of-range immediates into in-range values
 if((unsigned(rnd[3:0]) &lt; 2) |  (unsigned(rnd[3:0]) &gt; 14)) then rnd[3] = ~rnd[3]

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
      let CurrentRoundKey[3:0]  : bits(128)  = get_velem(vs2, EGW=128, i);
      let RoundKeyB[3:0] : bits(32)  = get_velem(vd, EGW=128, i); // Previous round key

      let w[0] : bits(32) = if (rnd[0]==1) then
        aes_subword_fwd(CurrentRoundKey[3]) XOR RoundKeyB[0];
      else
        aes_subword_fwd(aes_rotword(CurrentRoundKey[3])) XOR aes_decode_rcon((rnd&gt;&gt;1) - 1) XOR RoundKeyB[0];
      w[1] : bits(32) = w[0] XOR RoundKeyB[1]
      w[2] : bits(32) = w[1] XOR RoundKeyB[2]
      w[3] : bits(32) = w[2] XOR RoundKeyB[3]
      set_velem(vd, EGW=128, i, w[3:0]);
    }
    RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vaesz">3.7. vaesz.vs</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector AES round zero encryption/decryption</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vaesz.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '00111'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>The <code>vd</code> register group overlaps the <code>vs2</code> register</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new round state</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A round-0 AES block cipher operation is performed. This operation is used for both encryption and decryption.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There is only a <code>.vs</code> form of the instruction.
<code>Vs2</code> holds a
scalar element group that is used
as the round key for all of the round state element groups.
The new round state output of each element group is produced by XORing
the round key with each element group of <code>vd</code>.</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This instruction is needed to avoid the need to "splat" a 128-bit vector register group when the round key is the same for
all 128-bit "lanes". Such a splat would typically be implemented with a <code>vrgather</code> instruction which would hurt performance
in many implementations.
This instruction only exists in the <code>.vs</code> form because the <code>.vv</code> form would be identical to the <code>vxor.vv vd, vs2, vd</code> instruction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VAESZ(vs2, vd) = {
  if(((vstart%EGS)&lt;&gt;0) | (LMUL*VLEN &lt; EGW))  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let state : bits(128) = get_velem(vd, EGW=128, i);
    let rkey  : bits(128) = get_velem(vs2, EGW=128, 0);
    let ark   : bits(128) = state ^ rkey;
    set_velem(vd, EGW=128, i, ark);
  }
  RETIRE_SUCCESS
  }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkned">Zvkned</a>, <a href="#zvkng">Zvkng</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vandn">3.8. vandn.[vv,vx]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Bitwise And-Not</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vandn.vv vd, vs2, vs1, vm<br>
vandn.vx vd, vs2, rs1, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '000001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '000001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Vector Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Op1  (to be inverted)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Op2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Scalar Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Op1  (to be inverted)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Op2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A bitwise <em>and-not</em> operation is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each bit of <code>Op1</code> is inverted and logically ANDed with the corresponding bits in <code>vs2</code>.
In the vector-scalar version, <code>Op1</code> is the sign-extended or truncated value in scalar
register <code>rs1</code>.
In the vector-vector version, <code>Op1</code> is <code>vs1</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note on necessity of instruction</div>
<div class="paragraph">
<p>This instruction is performance-critical to SHA3. Specifically, the Chi step of the FIPS 202 Keccak Permutation.
Emulating it via 2 instructions is expected to have significant performance impact.
The <code>.vv</code> form of the instruction is what is needed for SHA3; the <code>.vx</code> form was added for completeness.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is no .vi version of this instruction because the same functionality can be achieved by using an inversion
of the immediate value with the <code>vand.vi</code> instruction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VANDN(vs2, vs1, vd, suffix)) = {
  foreach (i from vstart to vl-1) {
    let op1 = match suffix {
      &quot;vv&quot; =&gt; get_velem(vs1, SEW, i),
      &quot;vx&quot; =&gt; sext_or_truncate_to_sew(X(vs1))
    };
    let op2 = get_velem(vs2, SEW, i);
    set_velem(vd, EEW=SEW, i, ~op1 &amp; op2);
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, <a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvks">Zvks</a>
<a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vbrev">3.9. vbrev.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Reverse Bits in Elements</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vbrev.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01010'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elements with bits reversed</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A bit reversal is performed on the bits of each element.</p>
</dd>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VBREV(vs2)) = {

  foreach (i from vstart to vl-1) {
    let input = get_velem(vs2, SEW, i);
    let output : bits(SEW) = 0;
    foreach (i from 0 to SEW-1)
      let output[SEW-1-i] = input[i];
    set_velem(vd, SEW, i, output)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vbrev8">3.10. vbrev8.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Reverse Bits in Bytes</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vbrev8.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01000'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elements with bit-reversed bytes</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A bit reversal is performed on the bits of each byte.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This instruction is commonly used for GCM when the zvkg extension is not implemented.
This byte-wise instruction is defined for all SEWs to eliminate the need to change SEW when operating on wider elements.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VBREV8(vs2)) = {

  foreach (i from vstart to vl-1) {
    let input = get_velem(vs2, SEW, i);
    let output : bits(SEW) = 0;
    foreach (i from 0 to SEW-8 by 8)
      let output[i+7..i] = reverse_bits_in_byte(input[i+7..i]);
    set_velem(vd, SEW, i, output)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, <a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvks">Zvks</a>
<a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vclmul">3.11. vclmul.[vv,vx]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Carry-less Multiply by vector or scalar - returning low half of product.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vclmul.vv vd, vs2, vs1, vm<br>
vclmul.vx vd, vs2, rs1, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '001100'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '001100'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 64</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1/Rs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplicand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carry-less product low</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Produces the low half of 128-bit carry-less product.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each 64-bit element in the <code>vs2</code> vector register is carry-less multiplied by
either each 64-bit element in <code>vs1</code> (vector-vector), or the 64-bit value
from integer register <code>rs1</code> (vector-scalar). The result is the least
significant 64 bits of the carry-less product.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The 64-bit carryless multiply instructions can be used for implementing GCM in the absence of the <code>zvkg</code> extension.
We do not make these instructions exclusive as the 64-bit carryless multiply is readily derived from the
instructions in the <code>zvkg</code> extension and can have utility in other areas.
Likewise, we treat other SEW values as reserved so as not to preclude
future extensions from using this opcode with different element widths.
For example, a future extension might define an <code>SEW</code>=32 version of this instruction to enable <code>Zve32*</code> implementations to have
vector carryless multiplication instructions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>

function clause execute (VCLMUL(vs2, vs1, vd, suffix)) = {

  foreach (i from vstart to vl-1) {
    let op1 : bits (64) = if suffix ==&quot;vv&quot; then get_velem(vs1,i)
                          else zext_or_truncate_to_sew(X(vs1));
    let op2 : bits (64) = get_velem(vs2,i);
    let product : bits (64) = clmul(op1,op2,SEW);
    set_velem(vd, i, product);
  }
  RETIRE_SUCCESS
}

function clmul(x, y, width) = {
  let result : bits(width) = zeros();
  foreach (i from 0 to (width - 1)) {
    if y[i] == 1 then result = result ^ (x &lt;&lt; i);
  }
  result
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbc">Zvbc</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvksc">Zvksc</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vclmulh">3.12. vclmulh.[vv,vx]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Carry-less Multiply by vector or scalar - returning high half of product.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vclmulh.vv vd, vs2, vs1, vm<br>
vclmulh.vx vd, vs2, rs1, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '001101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '001101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 64</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multiplicand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carry-less product high</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Produces the high half of 128-bit carry-less product.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each 64-bit element in the <code>vs2</code> vector register is carry-less multiplied by
either each 64-bit element in <code>vs1</code> (vector-vector), or the 64-bit value
from integer register <code>rs1</code> (vector-scalar). The result is the most
significant 64 bits of the carry-less product.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VCLMULH(vs2, vs1, vd, suffix)) = {

  foreach (i from vstart to vl-1) {
    let op1 : bits (64) = if suffix ==&quot;vv&quot; then get_velem(vs1,i)
                          else zext_or_truncate_to_sew(X(vs1));
    let op2 : bits (64) = get_velem(vs2, i);
    let product : bits (64) = clmulh(op1, op2, SEW);
    set_velem(vd, i, product);
  }
  RETIRE_SUCCESS
}

function clmulh(x, y, width) = {
  let result : bits(width) = 0;
  foreach (i from 1 to (width - 1)) {
    if y[i] == 1 then result = result ^ (x &gt;&gt; (width - i));
  }
  result
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbc">Zvbc</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvksc">Zvksc</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vclz">3.13. vclz.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Count Leading Zeros</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vclz.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01100'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count of leading zero bits</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A leading zero count is performed on each element.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The result for zero-valued inputs is the value SEW.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VCLZ(vs2)) = {

  foreach (i from vstart to vl-1) {
    let input = get_velem(vs2, SEW, i);
    for (j = (SEW - 1); j &gt;= 0;  j--)
      if [input[j]] == 0b1 then break;
    set_velem(vd, SEW, i, SEW - 1 - j)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vcpop">3.14. vcpop.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Count the number of bits set in each element</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vcpop.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01110'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count of bits set</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A population count is performed on each element.</p>
</dd>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VCPOP(vs2)) = {

  foreach (i from vstart to vl-1) {
    let input = get_velem(vs2, SEW, i);
    let output : bits(SEW) = 0;
    for (j = 0; j &lt; SEW;  j++)
      output = output + input[j];
    set_velem(vd, SEW, i, output)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vctz">3.15. vctz.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Count Trailing Zeros</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vctz.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01101'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count of trailing zero bits</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A trailing zero count is performed on each element.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VCTZ(vs2)) = {

  foreach (i from vstart to vl-1) {
    let input = get_velem(vs2, SEW, i);
    for (j = 0; j &lt; SEW;  j++)
      if [input[j]] == 0b1 then break;
    set_velem(vd, SEW, i, j)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vghsh">3.16. vghsh.vv</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Add-Multiply over GHASH Galois-Field</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vghsh.vv vd, vs2, vs1</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101100'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">SEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partial hash (Y<sub>i</sub>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cipher text (X<sub>i</sub>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash Subkey (H)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partial-hash (Y<sub>i+1</sub>)</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A single "iteration" of the GHASH<sub>H</sub> algorithm is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This instruction treats all of the inputs and outputs as 128-bit polynomials and
performs operations over GF[2].
It produces the next partial hash (Y<sub>i+1</sub>) by adding the current partial
hash (Y<sub>i</sub>) to the cipher text block (X<sub>i</sub>) and then multiplying (over GF(2<sup>128</sup>))
this sum by the Hash Subkey (H).</p>
</div>
<div class="paragraph">
<p>The multiplication over GF(2<sup>128</sup>) is a carryless multiply of two 128-bit polynomials
modulo GHASH&#8217;s irreducible polynomial (x<sup>128</sup> + x<sup>7</sup> + x<sup>2</sup> + x + 1).</p>
</div>
<div class="paragraph">
<p>The operation can be compactly defined as
Y<sub>i+1</sub> = ((Y<sub>i</sub> ^ X<sub>i</sub>) &#183; H)</p>
</div>
<div class="paragraph">
<p>The NIST specification (see <a href="#zvkg">Zvkg</a>) orders the coefficients from left to right x<sub>0</sub>x<sub>1</sub>x<sub>2</sub>&#8230;&#8203;x<sub>127</sub>
for a polynomial x<sub>0</sub> + x<sub>1</sub>u +x<sub>2</sub> u<sup>2</sup> + &#8230;&#8203; + x<sub>127</sub>u<sup>127</sup>. This can be viewed as a collection of
byte elements in memory with the byte containing the lowest coefficients (i.e., 0,1,2,3,4,5,6,7)
residing at the lowest memory address. Since the bits in the bytes are reversed,
This instruction internally performs bit swaps within bytes to put the bits in the standard ordering
(e.g., 7,6,5,4,3,2,1,0).</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We are bit-reversing the bytes of inputs and outputs so that the intermediate values are consistent
with the NIST specification. These reversals are inexpensive to implement as they unconditionally
swap bit positions and therefore do not require any logic.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the same hash subkey <code>H</code> will typically be used repeatedly on a given message,
a future extension might define a vector-scalar version of this instruction where
<code>vs2</code> is the scalar element group. This would help reduce register pressure when <code>LMUL</code> &gt; 1.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pseudocode"><span></span>function clause execute (VGHSH(vs2, vs1, vd)) = {
  // operands are input with bits reversed in each byte
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let Y = (get_velem(vd,EGW=128,i));  // current partial-hash
    let X = get_velem(vs1,EGW=128,i);  // block cipher output
    let H = brev8(get_velem(vs2,EGW=128,i)); // Hash subkey

    let Z : bits(128) = 0;

    let S = brev8(Y ^ X);

    for (int bit = 0; bit &lt; 128; bit++) {
      if bit_to_bool(S[bit])
        Z ^= H

      bool reduce = bit_to_bool(H[127]);
      H = H &lt;&lt; 1; // left shift H by 1
      if (reduce)
        H ^= 0x87; // Reduce using x^7 + x^2 + x^1 + 1 polynomial
    }

    let result = brev8(Z); // bit reverse bytes to get back to GCM standard ordering
    set_velem(vd, EGW=128, i, result);
  }
  RETIRE_SUCCESS
 }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkg">Zvkg</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vgmul">3.17. vgmul.vv</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Multiply over GHASH Galois-Field</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vgmul.vv vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '10001'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">SEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplicand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A GHASH<sub>H</sub> multiply is performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This instruction treats all of the inputs and outputs as 128-bit polynomials and
performs operations over GF[2].
It produces the product over GF(2<sup>128</sup>) of the two 128-bit inputs.</p>
</div>
<div class="paragraph">
<p>The multiplication over GF(2<sup>128</sup>) is a carryless multiply of two 128-bit polynomials
modulo GHASH&#8217;s irreducible polynomial (x<sup>128</sup> + x<sup>7</sup> + x<sup>2</sup> + x + 1).</p>
</div>
<div class="paragraph">
<p>The NIST specification (see <a href="#zvkg">Zvkg</a>) orders the coefficients from left to right x<sub>0</sub>x<sub>1</sub>x<sub>2</sub>&#8230;&#8203;x<sub>127</sub>
for a polynomial x<sub>0</sub> + x<sub>1</sub>u +x<sub>2</sub> u<sup>2</sup> + &#8230;&#8203; + x<sub>127</sub>u<sup>127</sup>. This can be viewed as a collection of
byte elements in memory with the byte containing the lowest coefficients (i.e., 0,1,2,3,4,5,6,7)
residing at the lowest memory address. Since the bits in the bytes are reversed,
This instruction internally performs bit swaps within bytes to put the bits in the standard ordering
(e.g., 7,6,5,4,3,2,1,0).</p>
</div>
<div class="paragraph">
<p>This instruction must always be implemented such that its execution latency does not depend
on the data being operated upon.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We are bit-reversing the bytes of inputs and outputs so that the intermediate values are consistent
with the NIST specification. These reversals are inexpensive to implement as they unconditionally
swap bit positions and therefore do not require any logic.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the same multiplicand will typically be used repeatedly on a given message,
a future extension might define a vector-scalar version of this instruction where
<code>vs2</code> is the scalar element group. This would help reduce register pressure when <code>LMUL</code> &gt; 1.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This instruction is identical to <code>vghsh.vv</code> with vs1=0.
This instruction is often used in GHASH code. In some cases it is followed
by an XOR to perform a multiply-add. Implementations may choose to fuse these
two instructions to improve performance on GHASH code that
doesn&#8217;t use the add-multiply form of the <code>vghsh.vv</code> instruction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pseudocode"><span></span>function clause execute (VGMUL(vs2, vs1, vd)) = {
  // operands are input with bits reversed in each byte
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let Y = brev8(get_velem(vd,EGW=128,i));  // Multiplier
    let H = brev8(get_velem(vs2,EGW=128,i)); // Multiplicand
    let Z : bits(128) = 0;

    for (int bit = 0; bit &lt; 128; bit++) {
      if bit_to_bool(Y[bit])
        Z ^= H

      bool reduce = bit_to_bool(H[127]);
      H = H &lt;&lt; 1; // left shift H by 1
      if (reduce)
        H ^= 0x87; // Reduce using x^7 + x^2 + x^1 + 1 polynomial
    }


    let result = brev8(Z);
    set_velem(vd, EGW=128, i, result);
  }
  RETIRE_SUCCESS
 }
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkg">Zvkg</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vrev8">3.18. vrev8.v</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector Reverse Bytes</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vrev8.v vd, vs2, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '01001'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte-reversed elements</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A byte reversal is performed on each element of <code>vs2</code>, effectively performing an endian swap.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This element-wise endian swapping is needed for several cryptographic algorithms including SHA2 and SM3.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VREV8(vs2)) = {
  foreach (i from vstart to vl-1) {
    input = get_velem(vs2, SEW, i);
    let output : SEW = 0;
    let j = SEW - 1;
    foreach (k from 0 to (SEW - 8) by 8) {
      output[k..(k + 7)] = input[(j - 7)..j];
      j = j - 8;
    set_velem(vd, SEW, i, output)
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, <a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvks">Zvks</a>
<a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vrol">3.19. vrol.[vv,vx]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector rotate left by vector/scalar.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vrol.vv vd, vs2, vs1, vm<br>
vrol.vx vd, vs2, rs1, vm<br></p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Vector Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotate amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotated data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Scalar Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotate amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotated data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A bitwise left rotation is performed on each element of <code>vs2</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The elements in <code>vs2</code> are rotated left by the rotate amount specified by either
the corresponding elements of <code>vs1</code> (vector-vector), or integer register <code>rs1</code>
(vector-scalar).
Only the low log2(<code>SEW</code>) bits of the rotate-amount value are used, all other
bits are ignored.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is no immediate form of this instruction (i.e., <code>vrol.vi</code>) as the same result can be achieved by negating
the rotate amount and using the immediate form of rotate right instruction (i.e., vror.vi).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VROL_VV(vs2, vs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=SEW, i,
      get_velem(vs2, i) &lt;&lt;&lt; (get_velem(vs1, i) &amp; (SEW-1))
    )
  }
  RETIRE_SUCCESS
}

function clause execute (VROL_VX(vs2, rs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=SEW, i,
      get_velem(vs2, i) &lt;&lt;&lt; (X(rs1) &amp; (SEW-1))
    )
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, <a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvks">Zvks</a>
<a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vror">3.20. vror.[vv,vx,vi]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector rotate right by vector/scalar/immediate.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vror.vv vd, vs2, vs1, vm<br>
vror.vx vd, vs2, rs1, vm<br>
vror.vi vd, vs2, uimm, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010100'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '010100'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Immediate)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVI'},
{bits: 5, name: 'uimm[4:0]'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 1, name: 'i5'},
{bits: 5, name: '01010'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Vector Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotate amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotated data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Scalar/Immediate Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rs1/imm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotate amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotated data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A bitwise right rotation is performed on each element of <code>vs2</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The elements in <code>vs2</code> are rotated right by the rotate amount specified by either
the corresponding elements of <code>vs1</code> (vector-vector), integer register <code>rs1</code>
(vector-scalar), or an immediate value (vector-immediate).
Only the low log2(<code>SEW</code>) bits of the rotate-amount value are used, all other
bits are ignored.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VROR_VV(vs2, vs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=SEW, i,
      get_velem(vs2, i) &gt;&gt;&gt; (get_velem(vs1, i) &amp; (SEW-1))
    )
  }
  RETIRE_SUCCESS
}

function clause execute (VROR_VX(vs2, rs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=SEW, i,
      get_velem(vs2, i) &gt;&gt;&gt; (X(rs1) &amp; (SEW-1))
    )
  }
  RETIRE_SUCCESS
}

function clause execute (VROR_VI(vs2, imm[5:0], vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=SEW, i,
      get_velem(vs2, i) &gt;&gt;&gt; (imm[5:0] &amp; (SEW-1))
    )
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a>, <a href="#zvkb">Zvkb</a>, <a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvks">Zvks</a>
<a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsha2c">3.21. vsha2c[hl].vv</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SHA-2 two rounds of compression.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsha2ch.vv vd, vs2, vs1<br>
vsha2cl.vv vd, vs2, vs1</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector) High part</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101110'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Vector) Low part</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101111'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>zvknha</code>: <code>SEW</code> is any value other than 32</p>
</li>
<li>
<p><code>zvknhb</code>: <code>SEW</code> is any value other than 32 or 64</p>
</li>
<li>
<p>The <code>vd</code> register group overlaps with either <code>vs1</code> or <code>vs2</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">current state {c, d, g, h}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MessageSched plus constant[3:0]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">current state {a, b, e, f}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">next state {a, b, e, f}</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code>=32: 2 rounds of SHA-256 compression are performed (<code>zvknha</code> and <code>zvknhb</code>)</p>
</li>
<li>
<p><code>SEW</code>=64: 2 rounds of SHA-512 compression are performed (<code>zvkhnb</code>)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Two words of <code>vs1</code> are processed with
the 8 words of current state held in <code>vd</code> and <code>vs1</code> to perform two
rounds of hash computation producing four words of the
next state.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Note to software developers</div>
<div class="paragraph">
<p>The NIST standard (see <a href="#zvknh">zvknh[ab]</a>) requires the final hash to be in big-endian byte ordering
within SEW-sized words. Since this instruction treats all words as little-endian,
software needs to perform an endian swap on the final output of this instruction
after all of the message blocks have been processed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>vsha2ch</code> version of this instruction uses the two most significant message schedule
words from the element group in <code>vs1</code>
while the <code>vsha2cl</code> version uses the two least significant message schedule words.
Otherwise, these versions of the instruction are identical.
Having a high and low version of this instruction typically improves performance when
interleaving independent hashing operations (i.e., when hashing several files at once).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preventing overlap between <code>vd</code> and <code>vs1</code> or <code>vs2</code> simplifies implementation with <code>VLEN &lt; EGW</code>.
This restriction does not have any coding impact since proper implementation of the algorithm requires
that <code>vd</code>, <code>vs1</code> and <code>vs2</code> each are different registers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VSHA2c(vs2, vs1, vd)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
	  let {a @ b @ e @ f} : bits(4*SEW) = get_velem(vs2, 4*SEW, i);
	  let {c @ d @ g @ h} : bits(4*SEW) = get_velem(vd, 4*SEW, i);
	  let MessageShedPlusC[3:0] : bits(4*SEW) = get_velem(vs1, 4*SEW, i);
	  let {W1, W0} == VSHA2cl ? MessageSchedPlusC[1:0] : MessageSchedPlusC[3:2]; // l vs h difference is the words selected

	  let T1 : bits(SEW) = h + sum1(e) + ch(e,f,g) + W0;
	  let T2 : bits(SEW) = sum0(a) + maj(a,b,c);
	  h  = g;
	  g  = f;
	  f  = e;
	  e  = d + T1;
	  d  = c;
	  c  = b;
	  b  = a;
	  a  = T1 + T2;


	  T1  = h + sum1(e) + ch(e,f,g) + W1;
	  T2  = sum0(a) + maj(a,b,c);
	  h = g;
	  g = f;
	  f = e;
	  e = d + T1;
	  d = c;
	  c = b;
	  b = a;
	  a = T1 + T2;
	  set_velem(vd, 4*SEW, i, {a @ b @ e @ f});
  }
  RETIRE_SUCCESS
  }
}

function sum0(x) = {
	match SEW {
		32 =&gt; rotr(x,2)  XOR rotr(x,13) XOR rotr(x,22),
		64 =&gt; rotr(x,28) XOR rotr(x,34) XOR rotr(x,39)
	}
}

function sum1(x) = {
	match SEW {
		32 =&gt; rotr(x,6)  XOR rotr(x,11) XOR rotr(x,25),
		64 =&gt; rotr(x,14) XOR rotr(x,18) XOR rotr(x,41)
	}
}

function ch(x, y, z) = ((x &amp; y) ^ ((~x) &amp; z))


function maj(x, y, z) =  ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z))

function ROTR(x,n) = (x &gt;&gt; n) | (x &lt;&lt; SEW - n)</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvknh">zvknh[ab]</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsha2ms">3.22. vsha2ms.vv</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SHA-2 message schedule.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsha2ms.vv vd, vs2, vs1</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>zvknha</code>: <code>SEW</code> is any value other than 32</p>
</li>
<li>
<p><code>zvknhb</code>: <code>SEW</code> is any value other than 32 or 64</p>
</li>
<li>
<p>The <code>vd</code> register group overlaps with either <code>vs1</code> or <code>vs2</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words {W[3],  W[2],  W[1],  W[0]}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words {W[11], W[10], W[9],  W[4]}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words {W[15], W[14], -, W[12]}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words {W[19], W[18], W[17], W[16]}</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code>=32: Four rounds of SHA-256 message schedule expansion are performed (<code>zvknha</code> and <code>zvknhb</code>)</p>
</li>
<li>
<p><code>SEW</code>=64: Four rounds of SHA-512 message schedule expansion are performed (<code>zvkhnb</code>)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Eleven of the last 16 <code>SEW</code>-sized message-schedule words from <code>vd</code> (oldest), <code>vs2</code>,
and <code>vs1</code> (most recent) are processed to produce the
next 4 message-schedule words.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Note to software developers</div>
<div class="paragraph">
<p>The first 16 SEW-sized words of the message schedule come from the <em>message block</em>
in big-endian byte order. Since this instruction treats all words as little endian,
software is required to endian swap these words.</p>
</div>
<div class="paragraph">
<p>All of the subsequent message schedule words are produced by this instruction and
therefore do not require an endian swap.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Note to software developers</div>
<div class="paragraph">
<p>Software is required to pack the words into element groups
as shown above in the arguments table. The indices indicate the relate age with
lower indices indicating older words.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Note to software developers</div>
<div class="paragraph">
<p>The {W<sub>11</sub>, W<sub>10</sub>, W<sub>9</sub>, W<sub>4</sub>} element group can easily be formed by using a vector
vmerge instruction with the appropriate mask (for example with <code>vl=4</code> and <code>4b0001</code>
as the 4 mask bits)</p>
</div>
<div class="paragraph">
<p><code>vmerge.vvm {W<sub>11</sub>, W<sub>10</sub>, W<sub>9</sub>, W<sub>4</sub>}, {W<sub>11</sub>, W<sub>10</sub>, W<sub>9</sub>, W<sub>8</sub>}, {W<sub>7</sub>, W<sub>6</sub>, W<sub>5</sub>, W<sub>4</sub>}, V0</code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preventing overlap between <code>vd</code> and <code>vs1</code> or <code>vs2</code> simplifies implementation with <code>VLEN &lt; EGW</code>.
This restriction does not have any coding impact since proper implementation of the algorithm requires
that <code>vd</code>, <code>vs1</code> and <code>vs2</code> each contain different portions of the message schedule.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VSHA2ms(vs2, vs1, vd)) = {
  // SEW32 = SHA-256
  // SEW64 =  SHA-512
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    {W[3] @  W[2] @  W[1] @  W[0]}  : bits(EGW) = get_velem(vd, EGW, i);
    {W[11] @ W[10] @ W[9] @  W[4]}  : bits(EGW) = get_velem(vs2, EGW, i);
    {W[15] @ W[14] @ W[13] @ W[12]} : bits(EGW) = get_velem(vs1, EGW, i);

    W[16] = sig1(W[14]) + W[9]  + sig0(W[1]) + W[0];
    W[17] = sig1(W[15]) + W[10] + sig0(W[2]) + W[1];
    W[18] = sig1(W[16]) + W[11] + sig0(W[3]) + W[2];
    W[19] = sig1(W[17]) + W[12] + sig0(W[4]) + W[3];

    set_velem(vd, EGW, i, {W[19] @ W[18] @ W[17] @ W[16]});
  }
  RETIRE_SUCCESS
  }
}

function sig0(x) = {
	match SEW {
		32 =&gt; (ROTR(x,7) XOR ROTR(x,18) XOR SHR(x,3)),
		64 =&gt; (ROTR(x,1) XOR ROTR(x,8) XOR SHR(x,7)));
	}
}

function sig1(x) = {
	match SEW {
		32 =&gt; (ROTR(x,17) XOR ROTR(x,19) XOR SHR(x,10),
		64 =&gt; ROTR(x,19) XOR ROTR(x,61) XOR SHR(x,6));
	}
}

function ROTR(x,n) = (x &gt;&gt; n) | (x &lt;&lt; SEW - n)
function SHR (x,n) = x &gt;&gt; n</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvkn">Zvkn</a>, <a href="#zvknc">Zvknc</a>, <a href="#zvkng">Zvkng</a>, <a href="#zvknh">zvknh[ab]</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsm3c">3.23. vsm3c.vi</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SM3 Compression</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsm3c.vi vd, vs2, uimm</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'uimm'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101011'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>The <code>vd</code> register group overlaps with the <code>vs2</code> register group</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current state {H,G.F,E,D,C,B,A}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uimm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round number (rnds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words {-,-,w[5],w[4],-,-,w[1],w[0]}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next state {H,G.F,E,D,C,B,A}</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Two rounds of SM3 compression are performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The current state of eight 32-bit words is read in as an element group from <code>vd</code>. Eight 32-bit
message words are read in as an element group from <code>vs2</code>, although only four of them are used.
All of the 32-bit input words are byte-swapped from big endian to little endian.
These inputs are processed somewhat differently based on the round group (as specified in rnds),
and the next state is generated as an element group of eight 32-bit words.
The next state of eight 32-bit words are generated,
swapped from little endian to big endian, and are returned in
an eight-element group.</p>
</div>
<div class="paragraph">
<p>The round number is provided by the 5-bit <code>rnds</code> unsigned immediate. Legal values are 0 - 31
and indicate which group of two rounds are being performed. For example, if rnds=1,
then rounds 2 and 3 are being performed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The round number is used in the rotation of the constant as well to inform the
behavior which differs between rounds 0-15 and rounds 16-63.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The endian byte swapping of the input and output words enables us to align with the SM3
specification without requiring that software perform these swaps.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preventing overlap between <code>vd</code> and <code>vs2</code> simplifies implementation with <code>VLEN &lt; EGW</code>.
This restriction does not have any coding impact since proper implementation of the algorithm requires
that <code>vd</code> and <code>vs2</code> each are different registers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VSM3C(rnds, vs2, vd)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {

  // load state
  let {Hi @ Gi @ Fi @ Ei @ Di @ Ci @ Bi @ Ai} : bits(256) : bits(256) = (get_velem(vd, 256, i));
  //load message schedule
  let {u_w7 @ u_w6 @ w5i @ w4i @ u_w3 @ u_w2 @ w1i @ w0i} : bits(256) = (get_velem(vs2, 256, i));
  // u_w inputs are unused

// perform endian swap
let H : bits(32) = rev8(Hi);
let G : bits(32) = rev8(Gi);
let F : bits(32) = rev8(Fi);
let E : bits(32) = rev8(Ei);
let D : bits(32) = rev8(Di);
let C : bits(32) = rev8(Ci);
let B : bits(32) = rev8(Bi);
let A : bits(32) = rev8(Ai);

let w5 = : bits(32) rev8(w5i);
let w4 = : bits(32) rev8(w4i);
let w1 = : bits(32) rev8(w1i);
let w0 = : bits(32) rev8(w0i);

let x0 :bits(32) = w0 ^ w4;  // W&#39;[0]
let x1 :bits(32) = w1 ^ w5;  // W&#39;[1]

let j = 2 * rnds;
let ss1 : bits(32) = ROL32(ROL32(A, 12) + E + ROL32(T_j(j), j % 32), 7);
let ss2 : bits(32) = ss1 ^ ROL32(A, 12);
let tt1 : bits(32) = FF_j(A, B, C, j) + D + ss2 + x0;
let tt2 : bits(32) = GG_j(E, F, G, j) + H + ss1 + w0;
D = C;
let : bits(32) C1 = ROL32(B, 9);
B = A;
let A1 : bits(32) = tt1;
H = G;
let G1 : bits(32) = ROL32(F, 19);
F = E;
let E1 : bits(32) = P_0(tt2);

j = 2 * rnds + 1;
ss1 = ROL32(ROL32(A1, 12) + E1 + ROL32(T_j(j), j % 32), 7);
ss2 = ss1 ^ ROL32(A1, 12);
tt1 = FF_j(A1, B, C1, j) + D + ss2 + x1;
tt2 = GG_j(E1, F, G1, j) + H + ss1 + w1;
D = C1;
let C2 : bits(32) = ROL32(B, 9);
B = A1;
let A2 : bits(32) = tt1;
H = G1;
let G2 = : bits(32) ROL32(F, 19);
F = E1;
let E2 = : bits(32) P_0(tt2);

// Update the destination register - swap back to big endian
let result : bits(256) = {rev8(G1) @ rev8(G2) @ rev8(E1) @ rev8(E2) @ rev8(C1) @ rev8(C2) @ rev8(A1) @ rev8(A2)};
set_velem(vd, 256, i, result);
      }

RETIRE_SUCCESS
  }
}

function FF1(X, Y, Z) = ((X) ^ (Y) ^ (Z))
function FF2(X, Y, Z) = (((X) &amp; (Y)) | ((X) &amp; (Z)) | ((Y) &amp; (Z)))

function FF_j(X, Y, Z, J) = (((J) &lt;= 15) ? FF1(X, Y, Z) : FF2(X, Y, Z))

function GG1(X, Y, Z) = ((X) ^ (Y) ^ (Z))
function GG2(X, Y, Z) = (((X) &amp; (Y)) | ((~(X)) &amp; (Z)))
.
function GG_j(X, Y, Z, J) = (((J) &lt;= 15) ? GG1(X, Y, Z) : GG2(X, Y, Z))

function T_j(J) = (((J) &lt;= 15) ? (0x79CC4519) : (0x7A879D8A))

function P_0(X) = ((X) ^ ROL32((X),  9) ^ ROL32((X), 17))</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvks">Zvks</a>, <a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a>, <a href="#zvksh">Zvksh</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsm3me">3.24. vsm3me.vv</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SM3 Message Expansion</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsm3me.vv vd, vs2, vs1</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '100000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>The <code>vd</code> register group overlaps with the <code>vs2</code> register group.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words W[7:0]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words W[15:8]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message words W[23:16]</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Eight rounds of SM3 message expansion are performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The sixteen most recent 32-bit message words are read in as two
eight-element groups from <code>vs1</code> and <code>vs2</code>. Each of these words is
swapped from big endian to little endian.
The next eight 32-bit message words are generated,
swapped from little endian to big endian, and are returned in
an eight-element group.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The endian byte swapping of the input and output words enables us to align with the SM3
specification without requiring that software perform these swaps.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preventing overlap between <code>vd</code> and <code>vs2</code> simplifies implementations with <code>VLEN &lt; EGW</code>.
This restriction should not have any coding impact since the algorithm requires these
values to be preserved for generating the next 8 words.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VSM3ME(vs2, vs1)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  foreach (i from eg_start to eg_len-1) {
    let w[7:0]  : bits(256) = get_velem(vs1, 256, i);
    let w[15:8] : bits(256) = get_velem(vs2, 256, i);

    // Byte Swap inputs from big-endian to little-endian
    let w15 = rev8(w[15]);
    let w14 = rev8(w[14]);
    let w13 = rev8(w[13]);
    let w12 = rev8(w[12]);
    let w11 = rev8(w[11]);
    let w10 = rev8(w[10]);
    let w9  = rev8(w[9]);
    let w8  = rev8(w[8]);
    let w7  = rev8(w[7]);
    let w6  = rev8(w[6]);
    let w5  = rev8(w[5]);
    let w4  = rev8(w[4]);
    let w3  = rev8(w[3]);
    let w2  = rev8(w[2]);
    let w1  = rev8(w[1]);
    let w0  = rev8(w[0]);

    // Note that some of the newly computed words are used in later invocations.
    let w[16] = ZVKSH_W(w0 @  w7 @  w13 @   w3 @  w10);
    let w[17] = ZVKSH_W(w1 @  w8 @  w14 @   w4 @  w11);
    let w[18] = ZVKSH_W(w2 @  w9 @  w15 @   w5 @  w12);
    let w[19] = ZVKSH_W(w3 @ w10 @  w16 @   w6 @  w13);
    let w[20] = ZVKSH_W(w4 @ w11 @  w17 @   w7 @  w14);
    let w[21] = ZVKSH_W(w5 @ w12 @  w18 @   w8 @  w15);
    let w[22] = ZVKSH_W(w6 @ w13 @  w19 @   w9 @  w16);
    let w[23] = ZVKSH_W(w7 @ w14 @  w20 @  w10 @  w17);

  // Byte swap outputs from little-endian back to big-endian
    let w16 : Bits(32) = rev8(W[16]);
    let w17 : Bits(32) = rev8(W[17]);
    let w18 : Bits(32) = rev8(W[18]);
    let w19 : Bits(32) = rev8(W[19]);
    let w20 : Bits(32) = rev8(W[20]);
    let w21 : Bits(32) = rev8(W[21]);
    let w22 : Bits(32) = rev8(W[22]);
    let w23 : Bits(32) = rev8(W[23]);


    // Update the destination register.
    set_velem(vd, 256, i, {w23 @ w22 @ w21 @ w20 @ w19 @ w18 @ w17 @ w16});
  }
  RETIRE_SUCCESS
  }
}

  function P_1(X) ((X) ^ ROL32((X), 15) ^ ROL32((X), 23))

  function ZVKSH_W(M16, M9, M3, M13, M6) = \
  (P1( (M16) ^  (M9) ^ ROL32((M3), 15) ) ^ ROL32((M13), 7) ^ (M6))</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvks">Zvks</a>, <a href="#zvksc">Zvksc</a>, <a href="#zvksg">Zvksg</a>, <a href="#zvksh">Zvksh</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsm4k">3.25. vsm4k.vi</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SM4 KeyExpansion</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsm4k.vi vd, vs2, uimm</p>
</dd>
<dt class="hdlist1">Encoding</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: 'uimm'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '100001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uimm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round group (rnd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current 4 round keys rK[0:3]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next 4 round keys rK'[0:3]</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Four rounds of the SM4 Key Expansion are performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Four round keys are read in as a 4-element group from <code>vs2</code>. Each of the next four round keys are generated
by iteratively XORing the last three round keys with a constant that is indexed by the Round Group Number,
performing a byte-wise substitution, and then performing XORs between rotated versions of this value
and the corresponding current round key.</p>
</div>
<div class="paragraph">
<p>The Round group number (<code>rnd</code>) comes from <code>uimm[2:0]</code>; the bits in <code>uimm[4:3]</code> are ignored.
Round group numbers range from 0 to 7 and indicate which
group of four round keys are being generated. Round Keys range from 0-31.
For example, if <code>rnd</code>=1, then round keys 4, 5, 6, and 7 are being generated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Software needs to generate the initial round keys. This is done by XORing the 128-bit encryption key with
the system parameters: FK[0:3]</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 1. System Parameters</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">FK</th>
<th class="tableblock halign-center valign-top">constant</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">A3B1BAC6</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">56AA3350</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">677D9197</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">B27022DC</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Implementation Hint</p>
</div>
<div class="paragraph">
<p>The round constants (CK) can be generated on the fly fairly cheaply.
If the bytes of the constants are assigned an incrementing index from 0 to 127, the value of each byte is equal to its index multiplied by 7 modulo 256.
Since the results are all limited to 8 bits, the modulo operation occurs for free:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>B[n] = n + 2n + 4n;
      = 8n + ~n + 1;</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>
function clause execute (vsm4k(uimm, vs2)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

  let B : bits(32) = 0;
  let S : bits(32) = 0;
  let rk4 : bits(32) = 0;
  let rk5 : bits(32) = 0;
  let rk6 : bits(32) = 0;
  let rk7 : bits(32) = 0;
  let rnd : bits(3) = uimm[2:0]; // Lower 3 bits

  foreach (i from eg_start to eg_len-1) {
    let (rk3 @ rk2 @ rk1 @ rk0) : bits(128) = get_velem(vs2, 128, i);

    B = rk1 ^ rk2 ^ rk3 ^ ck(4 * rnd);
    S = sm4_subword(B);
    rk4 = ROUND_KEY(rk0, S);

    B = rk2 ^ rk3 ^ rk4 ^ ck(4 * rnd + 1);
    S = sm4_subword(B);
    rk5 = ROUND_KEY(rk1, S);

    B = rk3 ^ rk4 ^ rk5 ^ ck(4 * rnd + 2);
    S = sm4_subword(B);
    rk6 = ROUND_KEY(rk2, S);

    B = rk4 ^ rk5 ^ rk6 ^ ck(4 * rnd + 3);
    S = sm4_subword(B);
    rk7 = ROUND_KEY(rk3, S);

    // Update the destination register.
   set_velem(vd, EGW=128, i, (rk7 @ rk6 @ rk5 @ rk4));
  }
  RETIRE_SUCCESS
  }
}

val round_key : bits(32) -&gt; bits(32)
function ROUND_KEY(X, S) = ((X) ^ ((S) ^ ROL32((S), 13) ^ ROL32((S), 23)))

// SM4 Constant Key (CK)
let ck : list(bits(32)) = [|
	0x00070E15, 0x1C232A31, 0x383F464D, 0x545B6269,
	0x70777E85, 0x8C939AA1, 0xA8AFB6BD, 0xC4CBD2D9,
	0xE0E7EEF5, 0xFC030A11, 0x181F262D, 0x343B4249,
	0x50575E65, 0x6C737A81, 0x888F969D, 0xA4ABB2B9,
	0xC0C7CED5, 0xDCE3EAF1, 0xF8FF060D, 0x141B2229,
	0x30373E45, 0x4C535A61, 0x686F767D, 0x848B9299,
	0xA0A7AEB5, 0xBCC3CAD1, 0xD8DFE6ED, 0xF4FB0209,
	0x10171E25, 0x2C333A41, 0x484F565D, 0x646B7279
  |]
};</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvks">Zvks</a>, <a href="#zvksc">Zvksc</a>, <a href="#zvksed">Zvksed</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vsm4r">3.26. vsm4r.[vv,vs]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector SM4 Rounds</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vsm4r.vv vd, vs2<br>
vsm4r.vs vd, vs2</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '10000'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101000'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-P'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPMVV'},
{bits: 5, name: '10000'},
{bits: 5, name: 'vs2'},
{bits: 1, name: '1'},
{bits: 6, name: '101001'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Reserved Encodings</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>SEW</code> is any value other than 32</p>
</li>
<li>
<p>Only for the <code>.vs</code> form: the <code>vd</code> register group overlaps the <code>vs2</code> register</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EGW</th>
<th class="tableblock halign-left valign-top">EGS</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current state X[0:3]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round keys rk[0:3]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next state X'[0:3]</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>Four rounds of SM4 Encryption/Decryption are performed.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The four words of current state are read as a 4-element group from 'vd'
and the round keys are read from either the corresponding 4-element group
in <code>vs2</code> (vector-vector form) or the scalar element group in <code>vs2</code>
(vector-scalar form).
The next four words of state are generated
by iteratively XORing the last three words of the state with
the corresponding round key, performing
a byte-wise substitution, and then performing XORs between rotated
versions of this value and the corresponding current state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In SM4, encryption and decryption are identical except that decryption consumes the round keys in the reverse order.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the first  four rounds of encryption, the <em>current state</em> is the plain text.
For the first four rounds of decryption, the <em>current state</em> is the cipher text.
For all subsequent rounds, the <em>current state</em> is the <em>next state</em> from the
previous four rounds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="pseudocode"><span></span>function clause execute (VSM4R(vd, vs2)) = {
  if(LMUL*VLEN &lt; EGW)  then {
    handle_illegal();  // illegal instruction exception
    RETIRE_FAIL
  } else {

  eg_len = (vl/EGS)
  eg_start = (vstart/EGS)

 let B  : bits(32) = 0;
 let S  : bits(32) = 0;
 let rk0 : bits(32) = 0;
 let rk1 : bits(32) = 0;
 let rk2 : bits(32) = 0;
 let rk3 : bits(32) = 0;
 let x0 : bits(32) = 0;
 let x1 : bits(32) = 0;
 let x2 : bits(32) = 0;
 let x3 : bits(32) = 0;
 let x4 : bits(32) = 0;
 let x5 : bits(32) = 0;
 let x6 : bits(32) = 0;
 let x7 : bits(32) = 0;

 let keyelem : bits(32) = 0;

  foreach (i from eg_start to eg_len-1) {
    keyelem = if suffix == &quot;vv&quot; then i else 0;
    {rk3 @ rk2 @ rk1 @ rk0} : bits(128) = get_velem(vs2, EGW=128, keyelem);
    {x3 @ x2 @ x1 @ x0} : bits(128) = get_velem(vd, EGW=128, i);

    B  = x1 ^ x2 ^ x3 ^ rk0;
    S = sm4_subword(B);
    x4 = sm4_round(x0, S);

    B = x2 ^ x3 ^ x4 ^ rk1;
    S = sm4_subword(B);
    x5= sm4_round(x1, S);

    B = x3 ^ x4 ^ x5 ^ rk2;
    S = sm4_subword(B);
    x6 = sm4_round(x2, S);

    B = x4 ^ x5 ^ x6 ^ rk3;
    S = sm4_subword(B);
    x7 = sm4_round(x3, S);

    set_velem(vd, EGW=128, i, (x7 @ x6 @ x5 @ x4));

  }
  RETIRE_SUCCESS
  }
}

val sm4_round : bits(32) -&gt; bits(32)
function sm4_round(X, S) = \
  ((X) ^ ((S) ^ ROL32((S), 2) ^ ROL32((S), 10) ^ ROL32((S), 18) ^ ROL32((S), 24)))</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvks">Zvks</a>, <a href="#zvksc">Zvksc</a>, <a href="#zvksed">Zvksed</a>, <a href="#zvksg">Zvksg</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="sect2">
<h3 id="insns-vwsll">3.27. vwsll.[vv,vx,vi]</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Synopsis</dt>
<dd>
<p>Vector widening shift left logical by vector/scalar/immediate.</p>
</dd>
<dt class="hdlist1">Mnemonic</dt>
<dd>
<p>vwsll.vv vd, vs2, vs1, vm<br>
vwsll.vx vd, vs2, rs1, vm<br>
vwsll.vi vd, vs2, uimm, vm</p>
</dd>
<dt class="hdlist1">Encoding (Vector-Vector)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVV'},
{bits: 5, name: 'vs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '110101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Scalar)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVX'},
{bits: 5, name: 'rs1'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '110101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Encoding (Vector-Immediate)</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>{reg:[
{bits: 7, name: 'OP-V'},
{bits: 5, name: 'vd'},
{bits: 3, name: 'OPIVI'},
{bits: 5, name: 'uimm[4:0]'},
{bits: 5, name: 'vs2'},
{bits: 1, name: 'vm'},
{bits: 6, name: '110101'},
]}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Vector Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shifted data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Vector-Scalar/Immediate Arguments</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Register</th>
<th class="tableblock halign-left valign-top">Direction</th>
<th class="tableblock halign-left valign-top">EEW</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rs1/imm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift amount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vs2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shifted data</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Description</dt>
<dd>
<p>A widening logical shift left is performed on each element of <code>vs2</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The elements in <code>vs2</code> are zero-extended to 2*<code>SEW</code> bits, then shifted left
by the shift amount specified by either
the corresponding elements of <code>vs1</code> (vector-vector), integer register <code>rs1</code>
(vector-scalar), or an immediate value (vector-immediate).
Only the low log2(2*<code>SEW</code>) bits of the shift-amount value are used, all other
bits are ignored.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Operation</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>function clause execute (VWSLL_VV(vs2, vs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=2*SEW, i,
      get_velem(vs2, i) &lt;&lt; (get_velem(vs1, i) &amp; ((2*SEW)-1))
    )
  }
  RETIRE_SUCCESS
}

function clause execute (VWSLL_VX(vs2, rs1, vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=2*SEW, i,
      get_velem(vs2, i) &lt;&lt; (X(rs1) &amp; ((2*SEW)-1))
    )
  }
  RETIRE_SUCCESS
}

function clause execute (VWSLL_VI(vs2, uimm[4:0], vd)) = {
  foreach (i from vstart to vl - 1) {
    set_velem(vd, EEW=2*SEW, i,
      get_velem(vs2, i) &lt;&lt; (uimm[4:0] &amp; ((2*SEW)-1))
    )
  }
  RETIRE_SUCCESS
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Included in</dt>
<dd>
<p><a href="#zvbb">Zvbb</a></p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bibliography">4. Bibliography</h2>
<div class="sectionbody">
<div class="paragraph">
<p>bibliography::../riscv-crypto-spec.bib[ieee]</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Encodings">5. Encodings</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="crypto_vector_instructions">Appendix A: Crypto Vector Cryptographic Instructions</h3>
<div class="paragraph">
<p>OP-P (0x77)
Crypto Vector instructions except Zvbb and Zvbc</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 18.1818%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 18.1818%;">
<col style="width: 4.5454%;">
<col style="width: 4.5454%;">
<col style="width: 4.546%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="5">Integer</th>
<th class="tableblock halign-center valign-top" colspan="4">Integer</th>
<th class="tableblock halign-center valign-top" colspan="4">FP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVF</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVI</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 3.0303%;">
<col style="width: 3.0303%;">
<col style="width: 3.0303%;">
<col style="width: 3.0303%;">
<col style="width: 18.1818%;">
<col style="width: 3.0303%;">
<col style="width: 3.0303%;">
<col style="width: 18.1818%;">
<col style="width: 18.1818%;">
<col style="width: 3.0303%;">
<col style="width: 3.0303%;">
<col style="width: 3.0304%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="5">funct6</th>
<th class="tableblock halign-center valign-top" colspan="4">funct6</th>
<th class="tableblock halign-center valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3me</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4k.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaeskf1.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VAES.vv</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VAES.vs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaeskf2.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm3c.vi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vghsh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2ch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsha2cl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. VAES.vv and VAES.vs encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesdm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesdf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesef</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaesz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsm4r</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vgmul</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="crypto_vector_instructions_Zvbb_Zvbc">Appendix B: Vector Bitmanip and Carryless Multiply Instructions</h3>
<div class="paragraph">
<p>OP-V (0x57)
<strong>Zvbb</strong>, <strong>Zvkb</strong>, and <strong>Zvbc</strong> Vector instructions <strong>in bold</strong></p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">Integer</th>
<th class="tableblock halign-left valign-top" colspan="4">Integer</th>
<th class="tableblock halign-left valign-top" colspan="4">FP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVF</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVI</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredsum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vandn</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredusum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredosum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vminu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredminu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredmin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmaxu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmaxu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredmax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaaddu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnj</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnjn</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vasubu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnjx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vasub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrgather</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vclmul</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vclmulh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslideup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslide1up</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfslide1up</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrgatherei16</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslidedown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslide1down</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfslide1down</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vadc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VWXUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VWFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VRXUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VRFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmadc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VXUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VFUNARY1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vror</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VMUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vrol</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01010x</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vror</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmerge/vmv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vcompress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmerge/vfmv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmseq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmandn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfeq</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsne</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsltu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmslt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmflt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsleu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmorn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfne</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfgt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsgtu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsgt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxnor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfge</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsaddu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdivu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfdiv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdiv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfrdiv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssubu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vremu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulhu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmul</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulhsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfrsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmv&lt;nr&gt;r</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnmsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnsrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnsra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmacc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnclipu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmsac</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnclip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnmsac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmsac</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwredsumu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwaddu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwredsum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwredusum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsubu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwredosum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwaddu.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwadd.w</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vwsll</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwadd.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsubu.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwsub.w</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsub.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmulu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmul</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmulsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmacc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwnmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmsac</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwnmsac</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 3. VXUNARY0 encoding space</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vzext.vf8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsext.vf8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vzext.vf4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsext.vf4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vzext.vf2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsext.vf2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vbrev8</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vrev8</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vbrev</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vclz</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vctz</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vcpop</strong></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crypto_vector_appx_sail">Appendix C: Supporting Sail Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains the supporting Sail code referenced by the
instruction descriptions throughout the specification.
The
<a href="https://github.com/rems-project/sail/blob/sail2/manual.pdf">Sail Manual</a>
is recommended reading in order to best understand the supporting code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sail"><span></span>// include::../../extern/sail-riscv/model/riscv_types_kext.sail[lines=12..-1]

/* Auxiliary function for performing GF multiplicaiton */
val xt2 : bits(8) -&gt; bits(8)
function xt2(x) = {
  (x &lt;&lt; 1) ^ (if bit_to_bool(x[7]) then 0x1b else 0x00)
}

val xt3 : bits(8) -&gt; bits(8)
function xt3(x) = x ^ xt2(x)

/* Multiply 8-bit field element by 4-bit value for AES MixCols step */
val gfmul : (bits(8), bits(4)) -&gt; bits(8)
function gfmul( x, y) = {
  (if bit_to_bool(y[0]) then             x    else 0x00) ^
  (if bit_to_bool(y[1]) then xt2(        x)   else 0x00) ^
  (if bit_to_bool(y[2]) then xt2(xt2(    x))  else 0x00) ^
  (if bit_to_bool(y[3]) then xt2(xt2(xt2(x))) else 0x00)
}

/* 8-bit to 32-bit partial AES Mix Colum - forwards */
val aes_mixcolumn_byte_fwd : bits(8) -&gt; bits(32)
function aes_mixcolumn_byte_fwd(so) = {
  gfmul(so, 0x3) @ so @ so @ gfmul(so, 0x2)
}

/* 8-bit to 32-bit partial AES Mix Colum - inverse*/
val aes_mixcolumn_byte_inv : bits(8) -&gt; bits(32)
function aes_mixcolumn_byte_inv(so) = {
  gfmul(so, 0xb) @ gfmul(so, 0xd) @ gfmul(so, 0x9) @ gfmul(so, 0xe)
}

/* 32-bit to 32-bit AES forward MixColumn */
val aes_mixcolumn_fwd : bits(32) -&gt; bits(32)
function aes_mixcolumn_fwd(x) = {
  let s0 : bits (8) = x[ 7.. 0];
  let s1 : bits (8) = x[15.. 8];
  let s2 : bits (8) = x[23..16];
  let s3 : bits (8) = x[31..24];
  let b0 : bits (8) = xt2(s0) ^ xt3(s1) ^    (s2) ^    (s3);
  let b1 : bits (8) =    (s0) ^ xt2(s1) ^ xt3(s2) ^    (s3);
  let b2 : bits (8) =    (s0) ^    (s1) ^ xt2(s2) ^ xt3(s3);
  let b3 : bits (8) = xt3(s0) ^    (s1) ^    (s2) ^ xt2(s3);
  b3 @ b2 @ b1 @ b0 /* Return value */
}

/* 32-bit to 32-bit AES inverse MixColumn */
val aes_mixcolumn_inv : bits(32) -&gt; bits(32)
function aes_mixcolumn_inv(x) = {
  let s0 : bits (8) = x[ 7.. 0];
  let s1 : bits (8) = x[15.. 8];
  let s2 : bits (8) = x[23..16];
  let s3 : bits (8) = x[31..24];
  let b0 : bits (8) = gfmul(s0, 0xE) ^ gfmul(s1, 0xB) ^ gfmul(s2, 0xD) ^ gfmul(s3, 0x9);
  let b1 : bits (8) = gfmul(s0, 0x9) ^ gfmul(s1, 0xE) ^ gfmul(s2, 0xB) ^ gfmul(s3, 0xD);
  let b2 : bits (8) = gfmul(s0, 0xD) ^ gfmul(s1, 0x9) ^ gfmul(s2, 0xE) ^ gfmul(s3, 0xB);
  let b3 : bits (8) = gfmul(s0, 0xB) ^ gfmul(s1, 0xD) ^ gfmul(s2, 0x9) ^ gfmul(s3, 0xE);
  b3 @ b2 @ b1 @ b0 /* Return value */
}

val aes_decode_rcon : bits(4) -&gt; bits(32)
function aes_decode_rcon(r) = {
  match r {
    0x0 =&gt; 0x00000001,
    0x1 =&gt; 0x00000002,
    0x2 =&gt; 0x00000004,
    0x3 =&gt; 0x00000008,
    0x4 =&gt; 0x00000010,
    0x5 =&gt; 0x00000020,
    0x6 =&gt; 0x00000040,
    0x7 =&gt; 0x00000080,
    0x8 =&gt; 0x0000001b,
    0x9 =&gt; 0x00000036,
    0xA =&gt; 0x00000000,
    0xB =&gt; 0x00000000,
    0xC =&gt; 0x00000000,
    0xD =&gt; 0x00000000,
    0xE =&gt; 0x00000000,
    0xF =&gt; 0x00000000
  }
}

/* SM4 SBox - only one sbox for forwards and inverse */
let sm4_sbox_table : list(bits(8)) = [|
0xD6, 0x90, 0xE9, 0xFE, 0xCC, 0xE1, 0x3D, 0xB7, 0x16, 0xB6, 0x14, 0xC2, 0x28,
0xFB, 0x2C, 0x05, 0x2B, 0x67, 0x9A, 0x76, 0x2A, 0xBE, 0x04, 0xC3, 0xAA, 0x44,
0x13, 0x26, 0x49, 0x86, 0x06, 0x99, 0x9C, 0x42, 0x50, 0xF4, 0x91, 0xEF, 0x98,
0x7A, 0x33, 0x54, 0x0B, 0x43, 0xED, 0xCF, 0xAC, 0x62, 0xE4, 0xB3, 0x1C, 0xA9,
0xC9, 0x08, 0xE8, 0x95, 0x80, 0xDF, 0x94, 0xFA, 0x75, 0x8F, 0x3F, 0xA6, 0x47,
0x07, 0xA7, 0xFC, 0xF3, 0x73, 0x17, 0xBA, 0x83, 0x59, 0x3C, 0x19, 0xE6, 0x85,
0x4F, 0xA8, 0x68, 0x6B, 0x81, 0xB2, 0x71, 0x64, 0xDA, 0x8B, 0xF8, 0xEB, 0x0F,
0x4B, 0x70, 0x56, 0x9D, 0x35, 0x1E, 0x24, 0x0E, 0x5E, 0x63, 0x58, 0xD1, 0xA2,
0x25, 0x22, 0x7C, 0x3B, 0x01, 0x21, 0x78, 0x87, 0xD4, 0x00, 0x46, 0x57, 0x9F,
0xD3, 0x27, 0x52, 0x4C, 0x36, 0x02, 0xE7, 0xA0, 0xC4, 0xC8, 0x9E, 0xEA, 0xBF,
0x8A, 0xD2, 0x40, 0xC7, 0x38, 0xB5, 0xA3, 0xF7, 0xF2, 0xCE, 0xF9, 0x61, 0x15,
0xA1, 0xE0, 0xAE, 0x5D, 0xA4, 0x9B, 0x34, 0x1A, 0x55, 0xAD, 0x93, 0x32, 0x30,
0xF5, 0x8C, 0xB1, 0xE3, 0x1D, 0xF6, 0xE2, 0x2E, 0x82, 0x66, 0xCA, 0x60, 0xC0,
0x29, 0x23, 0xAB, 0x0D, 0x53, 0x4E, 0x6F, 0xD5, 0xDB, 0x37, 0x45, 0xDE, 0xFD,
0x8E, 0x2F, 0x03, 0xFF, 0x6A, 0x72, 0x6D, 0x6C, 0x5B, 0x51, 0x8D, 0x1B, 0xAF,
0x92, 0xBB, 0xDD, 0xBC, 0x7F, 0x11, 0xD9, 0x5C, 0x41, 0x1F, 0x10, 0x5A, 0xD8,
0x0A, 0xC1, 0x31, 0x88, 0xA5, 0xCD, 0x7B, 0xBD, 0x2D, 0x74, 0xD0, 0x12, 0xB8,
0xE5, 0xB4, 0xB0, 0x89, 0x69, 0x97, 0x4A, 0x0C, 0x96, 0x77, 0x7E, 0x65, 0xB9,
0xF1, 0x09, 0xC5, 0x6E, 0xC6, 0x84, 0x18, 0xF0, 0x7D, 0xEC, 0x3A, 0xDC, 0x4D,
0x20, 0x79, 0xEE, 0x5F, 0x3E, 0xD7, 0xCB, 0x39, 0x48
|]

let aes_sbox_fwd_table : list(bits(8)) = [|
0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe,
0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4,
0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7,
0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3,
0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09,
0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3,
0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe,
0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85,
0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92,
0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c,
0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19,
0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14,
0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2,
0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5,
0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25,
0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86,
0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e,
0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42,
0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
|]
    
let aes_sbox_inv_table : list(bits(8)) = [|
0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81,
0xf3, 0xd7, 0xfb, 0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e,
0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb, 0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23,
0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e, 0x08, 0x2e, 0xa1, 0x66,
0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 0x72,
0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65,
0xb6, 0x92, 0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46,
0x57, 0xa7, 0x8d, 0x9d, 0x84, 0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a,
0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 0xd0, 0x2c, 0x1e, 0x8f, 0xca,
0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 0x3a, 0x91,
0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6,
0x73, 0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8,
0x1c, 0x75, 0xdf, 0x6e, 0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f,
0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2,
0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 0x1f, 0xdd, 0xa8,
0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f,
0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93,
0xc9, 0x9c, 0xef, 0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb,
0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6,
0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d
|]

/* Lookup function - takes an index and a list, and retrieves the
 * x&#39;th element of that list.
 */
val sbox_lookup : (bits(8), list(bits(8))) -&gt; bits(8)
function sbox_lookup(x, table) = {
  match (x, table) {
    (0x00, t0::tn) =&gt; t0,
    (   y, t0::tn) =&gt; sbox_lookup(x - 0x01, tn)
  }
}

/* Easy function to perform a forward AES SBox operation on 1 byte. */
val aes_sbox_fwd : bits(8) -&gt; bits(8)
function aes_sbox_fwd(x) = sbox_lookup(x, aes_sbox_fwd_table)

/* Easy function to perform an inverse AES SBox operation on 1 byte. */
val aes_sbox_inv : bits(8) -&gt; bits(8)
function aes_sbox_inv(x) = sbox_lookup(x, aes_sbox_inv_table)

/* AES SubWord function used in the key expansion
 * - Applies the forward sbox to each byte in the input word.
 */
val aes_subword_fwd : bits(32) -&gt; bits(32)
function aes_subword_fwd(x) = {
  aes_sbox_fwd(x[31..24]) @
  aes_sbox_fwd(x[23..16]) @
  aes_sbox_fwd(x[15.. 8]) @
  aes_sbox_fwd(x[ 7.. 0])
}

/* AES Inverse SubWord function.
 * - Applies the inverse sbox to each byte in the input word.
 */
val aes_subword_inv : bits(32) -&gt; bits(32)
function aes_subword_inv(x) = {
  aes_sbox_inv(x[31..24]) @
  aes_sbox_inv(x[23..16]) @
  aes_sbox_inv(x[15.. 8]) @
  aes_sbox_inv(x[ 7.. 0]) 
}

/* Easy function to perform an SM4 SBox operation on 1 byte. */
val sm4_sbox : bits(8) -&gt; bits(8)
function sm4_sbox(x) = sbox_lookup(x, sm4_sbox_table)

val aes_get_column : (bits(128), nat) -&gt; bits(32)
function aes_get_column(state,c) = (state &gt;&gt; (to_bits(7, 32 * c)))[31..0]

/* 64-bit to 64-bit function which applies the AES forward sbox to each byte
 * in a 64-bit word.
 */
val aes_apply_fwd_sbox_to_each_byte : bits(64) -&gt; bits(64)
function aes_apply_fwd_sbox_to_each_byte(x) = {
  aes_sbox_fwd(x[63..56]) @
  aes_sbox_fwd(x[55..48]) @
  aes_sbox_fwd(x[47..40]) @
  aes_sbox_fwd(x[39..32]) @
  aes_sbox_fwd(x[31..24]) @
  aes_sbox_fwd(x[23..16]) @
  aes_sbox_fwd(x[15.. 8]) @
  aes_sbox_fwd(x[ 7.. 0])
}

/* 64-bit to 64-bit function which applies the AES inverse sbox to each byte
 * in a 64-bit word. 
 */
val aes_apply_inv_sbox_to_each_byte : bits(64) -&gt; bits(64)
function aes_apply_inv_sbox_to_each_byte(x) = {
  aes_sbox_inv(x[63..56]) @
  aes_sbox_inv(x[55..48]) @
  aes_sbox_inv(x[47..40]) @
  aes_sbox_inv(x[39..32]) @
  aes_sbox_inv(x[31..24]) @
  aes_sbox_inv(x[23..16]) @
  aes_sbox_inv(x[15.. 8]) @
  aes_sbox_inv(x[ 7.. 0])
}

/*
 * AES full-round transformation functions.
 */

val getbyte : (bits(64), int) -&gt; bits(8)
function getbyte(x, i) = (x &gt;&gt; to_bits(6, i * 8))[7..0]

val aes_rv64_shiftrows_fwd : (bits(64), bits(64)) -&gt; bits(64)
function aes_rv64_shiftrows_fwd(rs2, rs1) = {
  getbyte(rs1, 3) @
  getbyte(rs2, 6) @
  getbyte(rs2, 1) @
  getbyte(rs1, 4) @
  getbyte(rs2, 7) @
  getbyte(rs2, 2) @
  getbyte(rs1, 5) @
  getbyte(rs1, 0)
}

val aes_rv64_shiftrows_inv : (bits(64), bits(64)) -&gt; bits(64)
function aes_rv64_shiftrows_inv(rs2, rs1) = {
  getbyte(rs2, 3) @
  getbyte(rs2, 6) @
  getbyte(rs1, 1) @
  getbyte(rs1, 4) @
  getbyte(rs1, 7) @
  getbyte(rs2, 2) @
  getbyte(rs2, 5) @
  getbyte(rs1, 0)
}

/* 128-bit to 128-bit implementation of the forward AES ShiftRows transform. 
 * Byte 0 of state is input column 0, bits  7..0.
 * Byte 5 of state is input column 1, bits 15..8.
 */
val aes_shift_rows_fwd : bits(128) -&gt; bits(128)
function aes_shift_rows_fwd(x) = {
  let ic3 : bits(32) = aes_get_column(x, 3); 
  let ic2 : bits(32) = aes_get_column(x, 2); 
  let ic1 : bits(32) = aes_get_column(x, 1); 
  let ic0 : bits(32) = aes_get_column(x, 0); 
  let oc0 : bits(32) = ic3[31..24] @ ic2[23..16] @ ic1[15.. 8] @ ic0[ 7.. 0];
  let oc1 : bits(32) = ic0[31..24] @ ic3[23..16] @ ic2[15.. 8] @ ic1[ 7.. 0];
  let oc2 : bits(32) = ic1[31..24] @ ic0[23..16] @ ic3[15.. 8] @ ic2[ 7.. 0];
  let oc3 : bits(32) = ic2[31..24] @ ic1[23..16] @ ic0[15.. 8] @ ic3[ 7.. 0];
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* 128-bit to 128-bit implementation of the inverse AES ShiftRows transform.
 * Byte 0 of state is input column 0, bits  7..0.
 * Byte 5 of state is input column 1, bits 15..8.
 */
val aes_shift_rows_inv : bits(128) -&gt; bits(128)
function aes_shift_rows_inv(x) = {
  let ic3 : bits(32) = aes_get_column(x, 3); /* In column 3 */
  let ic2 : bits(32) = aes_get_column(x, 2); 
  let ic1 : bits(32) = aes_get_column(x, 1); 
  let ic0 : bits(32) = aes_get_column(x, 0); 
  let oc0 : bits(32) = ic1[31..24] @ ic2[23..16] @ ic3[15.. 8] @ ic0[ 7.. 0];
  let oc1 : bits(32) = ic2[31..24] @ ic3[23..16] @ ic0[15.. 8] @ ic1[ 7.. 0];
  let oc2 : bits(32) = ic3[31..24] @ ic0[23..16] @ ic1[15.. 8] @ ic2[ 7.. 0];
  let oc3 : bits(32) = ic0[31..24] @ ic1[23..16] @ ic2[15.. 8] @ ic3[ 7.. 0];
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* Applies the forward sub-bytes step of AES to a 128-bit vector
 * representation of its state.
 */
val aes_subbytes_fwd : bits(128) -&gt; bits(128)
function aes_subbytes_fwd(x) = {
  let oc0 : bits(32) = aes_subword_fwd(aes_get_column(x, 0));
  let oc1 : bits(32) = aes_subword_fwd(aes_get_column(x, 1));
  let oc2 : bits(32) = aes_subword_fwd(aes_get_column(x, 2));
  let oc3 : bits(32) = aes_subword_fwd(aes_get_column(x, 3));
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* Applies the inverse sub-bytes step of AES to a 128-bit vector
 * representation of its state.
 */
val aes_subbytes_inv : bits(128) -&gt; bits(128)
function aes_subbytes_inv(x) = {
  let oc0 : bits(32) = aes_subword_inv(aes_get_column(x, 0));
  let oc1 : bits(32) = aes_subword_inv(aes_get_column(x, 1));
  let oc2 : bits(32) = aes_subword_inv(aes_get_column(x, 2));
  let oc3 : bits(32) = aes_subword_inv(aes_get_column(x, 3));
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* Applies the forward MixColumns step of AES to a 128-bit vector
 * representation of its state.
 */
val aes_mixcolumns_fwd : bits(128) -&gt; bits(128)
function aes_mixcolumns_fwd(x) = {
  let oc0 : bits(32) = aes_mixcolumn_fwd(aes_get_column(x, 0));
  let oc1 : bits(32) = aes_mixcolumn_fwd(aes_get_column(x, 1));
  let oc2 : bits(32) = aes_mixcolumn_fwd(aes_get_column(x, 2));
  let oc3 : bits(32) = aes_mixcolumn_fwd(aes_get_column(x, 3));
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* Applies the inverse MixColumns step of AES to a 128-bit vector
 * representation of its state.
 */
val aes_mixcolumns_inv : bits(128) -&gt; bits(128)
function aes_mixcolumns_inv(x) = {
  let oc0 : bits(32) = aes_mixcolumn_inv(aes_get_column(x, 0));
  let oc1 : bits(32) = aes_mixcolumn_inv(aes_get_column(x, 1));
  let oc2 : bits(32) = aes_mixcolumn_inv(aes_get_column(x, 2));
  let oc3 : bits(32) = aes_mixcolumn_inv(aes_get_column(x, 3));
  (oc3 @ oc2 @ oc1 @ oc0) /* Return value */
}

/* Performs the word rotation for AES key schedule
*/

val aes_rotword : bits(32) -&gt; bits(32)
function aes_rotword(x) = {
  let a0 : bits (8) = x[ 7.. 0];
  let a1 : bits (8) = x[15.. 8];
  let a2 : bits (8) = x[23..16];
  let a3 : bits (8) = x[31..24];
  (a0 @ a3 @ a2 @ a1) /* Return Value */
}

val brev : bits(SEW) -&gt; bits(SEW)
function brev(x) = {
  let output : bits(SEW) = 0;
  foreach (i from 0 to SEW-8 by 8) 
    output[i+7..i] = reverse_bits_in_byte(input[i+7..i]);
  output /* Return Value */
}

val reverse_bits_in_byte : bits(8) -&gt; bits(8)
function reverse_bits_in_byte(x) = {
  let output : bits(8) = 0;
  foreach (i from 0 to 7) 
    output[i] = x[7-i]);
  output /* Return Value */
}

val rev8 : bits(SEW) -&gt; bits(SEW)
function rev8(x) = {     // endian swap
  let output : bits(SEW) = 0;
    let j = SEW - 1;
    foreach (k from 0 to (SEW - 8) by 8) {
      output[k..(k + 7)] = x[(j - 7)..j];
      j = j - 8;
  output /* Return Value */
  }
  RETIRE_SUCCESS


val rol32 : bits(32) -&gt; bits(32)
function ROL32(x,n) = (X &lt;&lt; N) | (X &gt;&gt; (32 - N))

val sm4_subword : bits(32) -&gt; bits(32)
function sm4_subword(x) = {
  sm4_sbox(x[31..24]) @
  sm4_sbox(x[23..16]) @
  sm4_sbox(x[15.. 8]) @
  sm4_sbox(x[ 7.. 0])
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v1.0.0<br>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>